import{c as U,o as d,e as T,aA as Ie,r as re,w as C,aB as Ne,aC as X,az as xe,Z as ie,bY as Ze,bZ as We,b_ as v,b$ as _e,a5 as me,c0 as O,c1 as ke,K as ce,c2 as Xe,c3 as Je,c4 as Re,$ as Me,a2 as ve,c5 as Qe,I as Fe,c6 as et,a6 as he,c7 as Z,c8 as tt,g as s,bh as Se,bi as at,c9 as lt,bk as st,ca as nt,cb as rt,cc as Ce,cd as it,ce as ot,bg as ut,cf as dt,cg as we,F as fe,ch as ct,aw as ne,U as mt,E as vt,ci as ht,a as te,Y as W,d as w,cj as ft,at as Ee,f as R,t as B,ck as pt,x as De,j as m,i as E,D as ae,cl as bt,cm as gt,C as Le,aH as yt,T as _t,cn as kt,_ as $e,bH as St,co as Ct,A as wt,B as Tt,b9 as Bt,bJ as Vt,b7 as Pt,b8 as It,cp as Nt,N as Te,b as de,W as Rt,b2 as Mt,b5 as Ft,k as Et,aR as Dt,a$ as Lt,p as $t,q as Ot}from"./admin-eKzY3vzh.js";const At={name:"PaginationToolbar"};function jt(e,t,a,i,r,l){return d(),T(xe,{class:"paginationToolbar codexToolbar",density:"compact",transform:"center bottom"},Ie({_:2},[re(e.$slots,(o,n)=>({name:n,fn:C(c=>[Ne(e.$slots,n,X({props:o},c),void 0,!0)])}))]),1024)}const fl=U(At,[["render",jt],["__scopeId","data-v-cfa8cce0"]]),pe=Symbol.for("vuetify:v-slider");function zt(e,t,a){const i=a==="vertical",r=t.getBoundingClientRect(),l="touches"in e?e.touches[0]:e;return i?l.clientY-(r.top+r.height/2):l.clientX-(r.left+r.width/2)}function Ut(e,t){return"touches"in e&&e.touches.length?e.touches[0][t]:"changedTouches"in e&&e.changedTouches.length?e.changedTouches[0][t]:e[t]}const qt=ie({disabled:{type:Boolean,default:null},error:Boolean,readonly:{type:Boolean,default:null},max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:e=>typeof e=="boolean"||e==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:e=>typeof e=="boolean"||e==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:e=>["vertical","horizontal"].includes(e)},reverse:Boolean,...Ze(),...We({elevation:2}),ripple:{type:Boolean,default:!0}},"Slider"),Gt=e=>{const t=v(()=>parseFloat(e.min)),a=v(()=>parseFloat(e.max)),i=v(()=>+e.step>0?parseFloat(e.step):0),r=v(()=>Math.max(_e(i.value),_e(t.value)));function l(o){if(o=parseFloat(o),i.value<=0)return o;const n=Re(o,t.value,a.value),c=t.value%i.value,h=Math.round((n-c)/i.value)*i.value+c;return parseFloat(Math.min(h,a.value).toFixed(r.value))}return{min:t,max:a,step:i,decimals:r,roundValue:l}},Yt=e=>{let{props:t,steps:a,onSliderStart:i,onSliderMove:r,onSliderEnd:l,getActiveThumb:o}=e;const{isRtl:n}=me(),c=O(t,"reverse"),h=v(()=>t.direction==="vertical"),V=v(()=>h.value!==c.value),{min:y,max:p,step:D,decimals:q,roundValue:A}=a,H=v(()=>parseInt(t.thumbSize,10)),G=v(()=>parseInt(t.tickSize,10)),j=v(()=>parseInt(t.trackSize,10)),L=v(()=>(p.value-y.value)/D.value),Y=O(t,"disabled"),F=v(()=>t.error||t.disabled?void 0:t.thumbColor??t.color),b=v(()=>t.error||t.disabled?void 0:t.trackColor??t.color),M=v(()=>t.error||t.disabled?void 0:t.trackFillColor??t.color),_=ke(!1),k=ke(0),P=ce(),I=ce();function f(u){var ye;const g=t.direction==="vertical",Ue=g?"top":"left",qe=g?"height":"width",Ge=g?"clientY":"clientX",{[Ue]:Ye,[qe]:Ke}=(ye=P.value)==null?void 0:ye.$el.getBoundingClientRect(),He=Ut(u,Ge);let ue=Math.min(Math.max((He-Ye-k.value)/Ke,0),1)||0;return(g?V.value:V.value!==n.value)&&(ue=1-ue),A(y.value+ue*(p.value-y.value))}const $=u=>{l({value:f(u)}),_.value=!1,k.value=0},J=u=>{I.value=o(u),I.value&&(I.value.focus(),_.value=!0,I.value.contains(u.target)?k.value=zt(u,I.value,t.direction):(k.value=0,r({value:f(u)})),i({value:f(u)}))},z={passive:!0,capture:!0};function Q(u){r({value:f(u)})}function le(u){u.stopPropagation(),u.preventDefault(),$(u),window.removeEventListener("mousemove",Q,z),window.removeEventListener("mouseup",le)}function S(u){var g;$(u),window.removeEventListener("touchmove",Q,z),(g=u.target)==null||g.removeEventListener("touchend",S)}function N(u){var g;J(u),window.addEventListener("touchmove",Q,z),(g=u.target)==null||g.addEventListener("touchend",S,{passive:!1})}function K(u){u.preventDefault(),J(u),window.addEventListener("mousemove",Q,z),window.addEventListener("mouseup",le,{passive:!1})}const x=u=>{const g=(u-y.value)/(p.value-y.value)*100;return Re(isNaN(g)?0:g,0,100)},ee=O(t,"showTicks"),se=v(()=>ee.value?t.ticks?Array.isArray(t.ticks)?t.ticks.map(u=>({value:u,position:x(u),label:u.toString()})):Object.keys(t.ticks).map(u=>({value:parseFloat(u),position:x(parseFloat(u)),label:t.ticks[u]})):L.value!==1/0?Xe(L.value+1).map(u=>{const g=y.value+u*D.value;return{value:g,position:x(g)}}):[]:[]),oe=v(()=>se.value.some(u=>{let{label:g}=u;return!!g})),ge={activeThumbRef:I,color:O(t,"color"),decimals:q,disabled:Y,direction:O(t,"direction"),elevation:O(t,"elevation"),hasLabels:oe,isReversed:c,indexFromEnd:V,min:y,max:p,mousePressed:_,numTicks:L,onSliderMousedown:K,onSliderTouchstart:N,parsedTicks:se,parseMouseMove:f,position:x,readonly:O(t,"readonly"),rounded:O(t,"rounded"),roundValue:A,showTicks:ee,startOffset:k,step:D,thumbSize:H,thumbColor:F,thumbLabel:O(t,"thumbLabel"),ticks:O(t,"ticks"),tickSize:G,trackColor:b,trackContainerRef:P,trackFillColor:M,trackSize:j,vertical:h};return Je(pe,ge),ge},Kt=ie({focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0},ripple:{type:[Boolean,Object],default:!0},...Me()},"VSliderThumb"),Ht=ve()({name:"VSliderThumb",directives:{Ripple:Qe},props:Kt(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a,emit:i}=t;const r=Fe(pe),{isRtl:l,rtlClasses:o}=me();if(!r)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:n,step:c,disabled:h,thumbSize:V,thumbLabel:y,direction:p,isReversed:D,vertical:q,readonly:A,elevation:H,mousePressed:G,decimals:j,indexFromEnd:L}=r,{textColorClasses:Y,textColorStyles:F}=et(n),{pageup:b,pagedown:M,end:_,home:k,left:P,right:I,down:f,up:$}=nt,J=[b,M,_,k,P,I,f,$],z=v(()=>c.value?[1,2,3]:[1,5,10]);function Q(S,N){if(!J.includes(S.key))return;S.preventDefault();const K=c.value||.1,x=(e.max-e.min)/K;if([P,I,f,$].includes(S.key)){const se=(q.value?[l.value?P:I,D.value?f:$]:L.value!==l.value?[P,$]:[I,$]).includes(S.key)?1:-1,oe=S.shiftKey?2:S.ctrlKey?1:0;N=N+se*K*z.value[oe]}else if(S.key===k)N=e.min;else if(S.key===_)N=e.max;else{const ee=S.key===M?1:-1;N=N-ee*K*(x>100?x/10:10)}return Math.max(e.min,Math.min(e.max,N))}function le(S){const N=Q(S,e.modelValue);N!=null&&i("update:modelValue",N)}return he(()=>{const S=Z(L.value?100-e.position:e.position,"%"),{elevationClasses:N}=tt(v(()=>h.value?void 0:H.value));return s("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":e.focused,"v-slider-thumb--pressed":e.focused&&G.value},e.class,o.value],style:[{"--v-slider-thumb-position":S,"--v-slider-thumb-size":Z(V.value)},e.style],role:"slider",tabindex:h.value?-1:0,"aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.modelValue,"aria-readonly":!!A.value,"aria-orientation":p.value,onKeydown:A.value?void 0:le},[s("div",{class:["v-slider-thumb__surface",Y.value,N.value],style:{...F.value}},null),Se(s("div",{class:["v-slider-thumb__ripple",Y.value],style:F.value},null),[[at("ripple"),e.ripple,null,{circle:!0,center:!0}]]),s(lt,{origin:"bottom center"},{default:()=>{var K;return[Se(s("div",{class:"v-slider-thumb__label-container"},[s("div",{class:["v-slider-thumb__label"]},[s("div",null,[((K=a["thumb-label"])==null?void 0:K.call(a,{modelValue:e.modelValue}))??e.modelValue.toFixed(c.value?j.value:1)])])]),[[st,y.value&&e.focused||y.value==="always"]])]}})])}),{}}}),xt=ie({start:{type:Number,required:!0},stop:{type:Number,required:!0},...Me()},"VSliderTrack"),Zt=ve()({name:"VSliderTrack",props:xt(),emits:{},setup(e,t){let{slots:a}=t;const i=Fe(pe);if(!i)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:r,parsedTicks:l,rounded:o,showTicks:n,tickSize:c,trackColor:h,trackFillColor:V,trackSize:y,vertical:p,min:D,max:q,indexFromEnd:A}=i,{roundedClasses:H}=rt(o),{backgroundColorClasses:G,backgroundColorStyles:j}=Ce(V),{backgroundColorClasses:L,backgroundColorStyles:Y}=Ce(h),F=v(()=>`inset-${p.value?"block":"inline"}-${A.value?"end":"start"}`),b=v(()=>p.value?"height":"width"),M=v(()=>({[F.value]:"0%",[b.value]:"100%"})),_=v(()=>e.stop-e.start),k=v(()=>({[F.value]:Z(e.start,"%"),[b.value]:Z(_.value,"%")})),P=v(()=>n.value?(p.value?l.value.slice().reverse():l.value).map((f,$)=>{var z;const J=f.value!==D.value&&f.value!==q.value?Z(f.position,"%"):void 0;return s("div",{key:f.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":f.position>=e.start&&f.position<=e.stop,"v-slider-track__tick--first":f.value===D.value,"v-slider-track__tick--last":f.value===q.value}],style:{[F.value]:J}},[(f.label||a["tick-label"])&&s("div",{class:"v-slider-track__tick-label"},[((z=a["tick-label"])==null?void 0:z.call(a,{tick:f,index:$}))??f.label])])}):[]);return he(()=>s("div",{class:["v-slider-track",H.value,e.class],style:[{"--v-slider-track-size":Z(y.value),"--v-slider-tick-size":Z(c.value)},e.style]},[s("div",{class:["v-slider-track__background",L.value,{"v-slider-track__background--opacity":!!r.value||!V.value}],style:{...M.value,...Y.value}},null),s("div",{class:["v-slider-track__fill",G.value],style:{...k.value,...j.value}},null),n.value&&s("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":n.value==="always"}]},[P.value])])),{}}}),Wt=ie({...it(),...qt(),...ot(),modelValue:{type:[Number,String],default:0}},"VSlider"),Xt=ve()({name:"VSlider",props:Wt(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,start:e=>!0,end:e=>!0},setup(e,t){let{slots:a,emit:i}=t;const r=ce(),{rtlClasses:l}=me(),o=Gt(e),n=ut(e,"modelValue",void 0,b=>o.roundValue(b??o.min.value)),{min:c,max:h,mousePressed:V,roundValue:y,onSliderMousedown:p,onSliderTouchstart:D,trackContainerRef:q,position:A,hasLabels:H,readonly:G}=Yt({props:e,steps:o,onSliderStart:()=>{i("start",n.value)},onSliderEnd:b=>{let{value:M}=b;const _=y(M);n.value=_,i("end",_)},onSliderMove:b=>{let{value:M}=b;return n.value=y(M)},getActiveThumb:()=>{var b;return(b=r.value)==null?void 0:b.$el}}),{isFocused:j,focus:L,blur:Y}=dt(e),F=v(()=>A(n.value));return he(()=>{const b=we.filterProps(e),M=!!(e.label||a.label||a.prepend);return s(we,X({class:["v-slider",{"v-slider--has-labels":!!a["tick-label"]||H.value,"v-slider--focused":j.value,"v-slider--pressed":V.value,"v-slider--disabled":e.disabled},l.value,e.class],style:e.style},b,{focused:j.value}),{...a,prepend:M?_=>{var k,P;return s(fe,null,[((k=a.label)==null?void 0:k.call(a,_))??(e.label?s(ct,{id:_.id.value,class:"v-slider__label",text:e.label},null):void 0),(P=a.prepend)==null?void 0:P.call(a,_)])}:void 0,default:_=>{let{id:k,messagesId:P}=_;return s("div",{class:"v-slider__container",onMousedown:G.value?void 0:p,onTouchstartPassive:G.value?void 0:D},[s("input",{id:k.value,name:e.name||k.value,disabled:!!e.disabled,readonly:!!e.readonly,tabindex:"-1",value:n.value},null),s(Zt,{ref:q,start:0,stop:F.value},{"tick-label":a["tick-label"]}),s(Ht,{ref:r,"aria-describedby":P.value,focused:j.value,min:c.value,max:h.value,modelValue:n.value,"onUpdate:modelValue":I=>n.value=I,position:F.value,elevation:e.elevation,onFocus:L,onBlur:Y,ripple:e.ripple},{"thumb-label":a["thumb-label"]})])}})}),{}}}),Jt={name:"PaginationSlider"};function Qt(e,t,a,i,r,l){return d(),T(Xt,X({"thumb-size":"36",class:"paginationSlider",density:"compact","hide-details":"auto",rounded:!0,"show-ticks":"always",step:1,"thumb-label":"always"},e.$attrs),null,16)}const pl=U(Jt,[["render",Qt],["__scopeId","data-v-825b160e"]]),ea={name:"PaginationNavButton"};function ta(e,t,a,i,r,l){return d(),T(ne,X({class:"paginationNavButton",height:"100%"},e.$attrs),Ie({_:2},[re(e.$slots,(o,n)=>({name:n,fn:C(c=>[Ne(e.$slots,n,X({props:o},c),void 0,!0)])}))]),1040)}const bl=U(ea,[["render",ta],["__scopeId","data-v-852fad11"]]),Be=mt.browser.vuetifyNullCode,aa=new Set(["",Be,Be.toString(),void 0]),la=function(e){let t;return e===void 0?t=e:e instanceof Object?t={value:e.pk,title:e.name}:t={value:e,title:e.toString()},e.url&&(t.url=e.url),t},sa=function(e,t){return e.title<t.title?-1:e.title>t.title?1:0},na=function(e,t){return Number.parseFloat(e.title)-Number.parseFloat(t.title)},ra=function(e,t,a=!1){const i=e||[],r=t&&t.toLowerCase();let l=[];for(const n of i){if(!n||aa.has(n.pk))continue;const c=la(n);c&&(!r||c.title&&c.title.toLowerCase().includes(r))&&l.push(c)}const o=a?na:sa;return l.sort(o)},ia={name:"PlaceholderLoading",props:{indeterminate:{type:Boolean,default:!0}}};function oa(e,t,a,i,r,l){return d(),T(vt,X({"aria-label":"loading",class:"codexProgressCircular",indeterminate:a.indeterminate},e.$attrs),null,16,["indeterminate"])}const Oe=U(ia,[["render",oa],["__scopeId","data-v-7bb4cf22"]]),ua=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],da=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],ca=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],ma=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],Ve=(e,t,a)=>{let i=e;return typeof t=="string"||Array.isArray(t)?i=e.toLocaleString(t,a):(t===!0||a!==void 0)&&(i=e.toLocaleString(void 0,a)),i};function va(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);t={bits:!1,binary:!1,space:!0,...t};const a=t.bits?t.binary?ma:ca:t.binary?da:ua,i=t.space?" ":"";if(t.signed&&e===0)return` 0${i}${a[0]}`;const r=e<0,l=r?"-":t.signed?"+":"";r&&(e=-e);let o;if(t.minimumFractionDigits!==void 0&&(o={minimumFractionDigits:t.minimumFractionDigits}),t.maximumFractionDigits!==void 0&&(o={maximumFractionDigits:t.maximumFractionDigits,...o}),e<1){const V=Ve(e,t.locale,o);return l+V+i+a[0]}const n=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),a.length-1);e/=(t.binary?1024:1e3)**n,o||(e=e.toPrecision(3));const c=Ve(Number(e),t.locale,o),h=a[n];return l+c+i+h}const ha=(e,t)=>e?`${ht(e)}/cover.webp?${t}`:window.CODEX.MISSING_COVER,fa={name:"BookCover",props:{group:{type:String,required:!0},childCount:{type:Number,default:1},finished:{type:Boolean},coverPk:{type:Number,required:!0}},data(){return{showPlaceholder:!1}},computed:{...te(W,{coverSrc:function(e){return ha(this.coverPk,e.page.coversTimestamp)}})},mounted:function(){this.delayPlaceholder()},methods:{delayPlaceholder:function(){setTimeout(()=>{this.showPlaceholder=!0},2e3)}}},pa={class:"bookCover"},ba={key:1,class:"childCount"};function ga(e,t,a,i,r,l){return d(),w("div",pa,[s(ft,{src:e.coverSrc,class:"coverImg"},null,8,["src"]),a.finished!==!0?(d(),w("div",{key:0,class:Ee({unreadFlag:!0,mixedreadFlag:a.finished===null})},null,2)):R("",!0),a.group!=="c"?(d(),w("span",ba,B(a.childCount),1)):R("",!0)])}const Ae=U(fa,[["render",ga],["__scopeId","data-v-9acb5f6a"]]),ya={name:"MetadataTags",props:{label:{type:String,required:!0},values:{type:Array,default(){return[]}},filter:{type:String,required:!1,default:void 0}},data(){return{mdiFilter:pt,mdiOpenInNew:De}},computed:{...te(W,{filterValues:function(e){const t=this.filter||this.label.toLowerCase();return e.settings.filters[t]}}),model(){return ra(this.values)}},methods:{chipColor:function(e){return this.filterValues&&this.filterValues.includes(e)?this.$vuetify.theme.current.colors["primary-darken-1"]:""}}},_a={key:0,class:"tags"},ka={class:"label"},Sa=["href"],Ca={key:1};function wa(e,t,a,i,r,l){return l.model&&l.model.length>0?(d(),w("div",_a,[s(gt,{value:l.model,multiple:"",class:"chipGroup"},{default:C(()=>[m("div",ka,B(a.label),1),(d(!0),w(fe,null,re(l.model,o=>(d(),T(bt,{key:`${a.label}/${o.value}`,color:l.chipColor(o.value),value:o.value},{default:C(()=>[o.url?(d(),w("a",{key:0,href:o.url,target:"_blank"},[E(B(o.title),1),s(ae,null,{default:C(()=>[E(B(r.mdiOpenInNew),1)]),_:1})],8,Sa)):(d(),w("span",Ca,B(o.title),1))]),_:2},1032,["color","value"]))),128))]),_:1},8,["value"])])):R("",!0)}const be=U(ya,[["render",wa],["__scopeId","data-v-59c9d373"]]),Ta={name:"MetadataTextBox",props:{label:{type:String,required:!0},value:{type:[Object,String,Number,Boolean],default:void 0},link:{type:[Boolean,String],default:!1},group:{type:String,default:""},obj:{type:Object,default:void 0}},data(){return{mdiOpenInNew:De}},computed:{computedValue(){return this.value!=null&&this.value instanceof Object?this.value.name:this.value},linkValue(){return this.link===!0?this.computedValue:this.link?this.link:!1},highlight(){var e;return((e=this.obj)==null?void 0:e.group)===this.group},pathArray(){if(this.computedValue)return this.computedValue.split("/")},folderPath(){if(this.pathArray)return this.pathArray.slice(0,-1).join("/")},basePath(){if(this.pathArray)return this.pathArray.at(-1)},groupTo(){const e=W();if(this.group!=="f"&&!e.settings.show[this.group]||this.group==="f"&&!e.page.adminFlags.folderView)return;let t;if(t=this.obj&&this.obj.group==this.group?this.obj.pk:this.value.pk,!t)return;const a=this.$router.currentRoute.value.params;if(!(a.group===this.group&&+a.pk===t))return{name:"browser",params:{group:this.group,pk:t}}}}},Ba={class:"textLabel"},Va={class:"textValue"},Pa=["href"],Ia={key:3,class:"textContent"},Na={key:4,id:"basePath"};function Ra(e,t,a,i,r,l){const o=Le("router-link");return l.computedValue?(d(),w("div",{key:0,class:Ee(["text",{highlight:l.highlight}])},[m("div",Ba,B(a.label),1),m("div",Va,[l.groupTo&&a.group==="f"?(d(),T(o,{key:0,id:"folderPath",to:l.groupTo,title:"Browse Folder"},{default:C(()=>[E(B(l.folderPath)+"/",1)]),_:1},8,["to"])):l.groupTo?(d(),T(o,{key:1,class:"textContent",to:l.groupTo,title:`Browse ${a.label}`},{default:C(()=>[E(B(l.computedValue),1)]),_:1},8,["to","title"])):a.link?(d(),w("a",{key:2,href:l.linkValue,target:"_blank"},[E(B(l.computedValue)+" ",1),s(ae,{size:"small"},{default:C(()=>[E(B(r.mdiOpenInNew),1)]),_:1})],8,Pa)):(d(),w("div",Ia,B(l.computedValue),1)),l.groupTo&&a.group==="f"?(d(),w("span",Na,B(l.basePath),1)):R("",!0)])],2)):R("",!0)}const je=U(Ta,[["render",Ra],["__scopeId","data-v-0d27e6b3"]]),Ma={name:"MetadataContributorsTable",props:{value:{type:Array,default:void 0}},data(){return{}},computed:{contributorsDict(){const e={};for(const{role:i,person:r}of this.value){const l=yt(i.name)+"s";e[l]||(e[l]=[]),e[l].push(r)}const t=Object.keys(e).sort((i,r)=>i.localeCompare(r)),a={};for(const i of t)a[i]=e[i].sort((r,l)=>r.name.localeCompare(l.name));return a}}},Fa={key:0},Ea=m("h3",null,"Contributors",-1);function Da(e,t,a,i,r,l){const o=be;return Object.keys(l.contributorsDict).length>0?(d(),w("div",Fa,[Ea,(d(!0),w(fe,null,re(Object.entries(l.contributorsDict),([n,c])=>(d(),T(o,{key:n,values:c,label:n,filter:"contributors"},null,8,["values","label"]))),128))])):R("",!0)}const La=U(Ma,[["render",Da]]),ze=new Set("rtl","btt");Object.freeze(ze);const $a=({pk:e,page:t,readingDirection:a,pageCount:i})=>{if(i){if(t)t=Number(t);else if(ze.has(a)){const r=Number(i)-1;t=Math.max(r,0)}else t=0;return{name:"reader",params:{pk:e,page:t}}}},Pe=_t("metadata",{state:()=>({md:void 0}),actions:{async loadMetadata({group:e,pk:t}){const a=W();await kt.getMetadata({group:e,pk:t},a.settings).then(i=>(this.md=i.data,!0)).catch(i=>{console.error(i),this.clearMetadata()})},clearMetadata(){this.md=void 0}}}),Oa=1160,Aa=.05,ja=250,za={name:"MetadataButton",components:{BookCover:Ae,CloseButton:$e,MetadataContributorsTable:La,MetadataTags:be,MetadataText:je,PlaceholderLoading:Oe},props:{group:{type:String,required:!0},pk:{type:Number,required:!0},children:{type:Number,default:1}},data(){return{mdiDownload:St,mdiTagOutline:Ct,dialog:!1,progress:0}},computed:{...wt(Tt,["isUserAdmin"]),...te(W,{twentyFourHourTime:e=>e.settings.twentyFourHourTime,readingDirectionTitles:e=>e.choices.static.readingDirection,identifierTypes:e=>e.choices.static.identifierType}),...te(Pe,{md:e=>e.md,downloadFileName:e=>{const t=e.md;return e.md.path?t.path.split("/").at(-1):Bt({seriesName:t.series.name,volumeName:t.volume.name,issueNumber:t.issueNumber,issueSuffix:t.issueSuffix})+"."+(void 0).fileType.toLowerCase()}}),...te(W,{q:e=>e.settings.q}),downloadURL(){return Vt(this.pk)},isReadButtonShown(){return this.group==="c"&&this.$route.name!="reader"},isReadButtonEnabled(){return this.$route.name==="browser"&&!!this.readerRoute},readButtonIcon(){return this.isReadButtonEnabled?Pt:It},readerRoute(){return $a(this.md)},formattedIssue(){if(!((this.md.issueNumber===null||this.md.issueNumber===void 0)&&!this.md.issueSuffix))return Nt(this.md)},readingDirectionText(){return this.readingDirectionTitles[this.md.readingDirection]},pages(){let e="";if(this.md.page){const a=Te.format(this.md.page);e+=`Read ${a} of `}const t=Te.format(this.md.pageCount);return e+=`${t} pages`,this.md.progress>0&&(e+=` (${Math.round(this.md.progress)}%)`),e},size(){return this.md.size>0?va(this.md.size):0},fileType(){return this.md.fileType||"Unknown"},titledIdentifiers(){if(!this.md.identifiers)return this.md.identifiers;const e=[];for(const t of this.md.identifiers){const a=t.name.split(":"),i=a[0],r=a[1],l=this.identifierTypeTitle(i);let o="";l&&l!=="None"&&(o+=l+":"),o+=r,e.push({...t,name:o})}return e}},watch:{dialog(e){e?this.dialogOpened():this.clearMetadata()}},methods:{...de(Pe,["clearMetadata","loadMetadata"]),...de(Rt,["downloadIOSPWAFix"]),...de(W,["identifierTypeTitle"]),dialogOpened(){this.loadMetadata({group:this.group,pk:this.pk}),this.startProgress()},startProgress(){this.startTime=Date.now(),this.estimatedMS=Math.max(Aa,this.children/Oa)*1e3,this.updateProgress()},updateProgress(){const e=Date.now()-this.startTime;this.progress=e/this.estimatedMS*100,!(this.progress>=100||this.md)&&setTimeout(()=>{this.updateProgress()},ja)},formatDateTime(e){return Mt(e,this.twentyFourHourTime)},download(){this.downloadIOSPWAFix(this.downloadURL,this.md.filename)}}},Ua=e=>($t("data-v-42e29afa"),e=e(),Ot(),e),qa={id:"metadataHeader"},Ga={id:"metadataBookCoverWrapper"},Ya={class:"inlineRow"},Ka={class:"inlineRow"},Ha={class:"inlineRow"},xa={key:1,class:"inlineRow"},Za={id:"metadataBody"},Wa={class:"mdSection"},Xa={class:"quintRow"},Ja={class:"mdSection"},Qa={class:"quarterRow"},el={class:"lastSmallRow"},tl={class:"halfRow mdSection"},al={class:"mdSection"},ll={class:"mdSection"},sl={class:"mdSection"},nl={class:"mdSection"},rl={class:"mdSection"},il={class:"mdSection inlineRow"},ol={class:"inlineRow"},ul={id:"footerLinks"},dl={id:"bottomRightButtons"},cl={key:1,id:"placeholderContainer"},ml=Ua(()=>m("div",{id:"placeholderTitle"},"Tags Loading",-1));function vl(e,t,a,i,r,l){const o=$e,n=je,c=Ae,h=be,V=Le("MetadataContributorsTable"),y=Oe;return d(),T(Lt,{modelValue:r.dialog,"onUpdate:modelValue":t[5]||(t[5]=p=>r.dialog=p),fullscreen:"",transition:"dialog-bottom-transition"},{activator:C(({props:p})=>[s(ne,X({"aria-label":"tags",class:"tagButton cardControlButton",icon:"",title:"Tags",variant:"text"},p,{onClick:t[0]||(t[0]=Ft(()=>{},["prevent"]))}),{default:C(()=>[s(ae,null,{default:C(()=>[E(B(r.mdiTagOutline),1)]),_:1})]),_:2},1040)]),default:C(()=>[e.md?(d(),w("div",{key:0,id:"metadataContainer",onKeyup:t[3]||(t[3]=Dt(p=>r.dialog=!1,["esc"]))},[m("header",qa,[s(o,{class:"closeButton",title:"Close Metadata (esc)",size:"x-large",onClick:t[1]||(t[1]=p=>r.dialog=!1)}),e.q?(d(),T(n,{key:0,id:"search",value:e.q,label:"Search Query",highlight:!0},null,8,["value"])):R("",!0),m("div",Ga,[s(c,{id:"bookCover","cover-pk":e.md.coverPk,group:a.group,"child-count":e.md.childCount,finished:e.md.finished},null,8,["cover-pk","group","child-count","finished"]),s(Et,{class:"bookCoverProgress","model-value":e.md.progress,rounded:"","background-color":"inherit",height:"2","aria-label":"% read"},null,8,["model-value"])]),m("div",Ya,[s(n,{id:"publisher",value:e.md.publisher,group:"p",label:"Publisher",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"]),s(n,{id:"imprint",value:e.md.imprint,group:"i",label:"Imprint",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"])]),m("div",Ka,[s(n,{id:"series",value:e.md.series,label:"Series",group:"s",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"])]),m("div",Ha,[s(n,{id:"volume",value:e.md.volume,label:"Volume",group:"v",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"]),s(n,{value:e.md.seriesVolumeCount,label:"Volume Count"},null,8,["value"]),s(n,{id:"issue",value:l.formattedIssue,label:"Issue",group:"c",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"]),s(n,{value:e.md.volumeIssueCount,label:"Issue Count"},null,8,["value"]),s(n,{value:e.md.name,label:"Title"},null,8,["value"])]),e.md.year||e.md.month||e.md.day?(d(),w("div",xa,[s(n,{value:e.md.year,label:"Year",class:"datePicker",type:"number"},null,8,["value"]),s(n,{value:e.md.month,label:"Month",class:"datePicker"},null,8,["value"]),s(n,{value:e.md.day,label:"Day",class:"datePicker"},null,8,["value"])])):R("",!0)]),m("div",Za,[m("section",Wa,[m("div",Xa,[s(n,{value:l.pages,label:"Pages"},null,8,["value"]),s(n,{label:"Finished",value:(!!e.md.finished).toString()},null,8,["value"]),s(n,{label:"Reading Direction",value:l.readingDirectionText},null,8,["value"]),s(n,{value:(!!e.md.monochrome).toString(),label:"Monochrome"},null,8,["value"]),s(n,{value:e.md.original_format,label:"Original Format"},null,8,["value"])])]),m("section",Ja,[m("div",Qa,[e.md.createdAt?(d(),T(n,{key:0,value:l.formatDateTime(e.md.createdAt),label:"Created at",class:"mtime"},null,8,["value"])):R("",!0),e.md.updatedAt?(d(),T(n,{key:1,value:l.formatDateTime(e.md.updatedAt),label:"Updated at",class:"mtime"},null,8,["value"])):R("",!0),s(n,{value:l.size,label:"Size"},null,8,["value"]),s(n,{value:l.fileType,label:"File Type"},null,8,["value"])]),m("div",el,[s(n,{group:"f",value:{pk:e.md.parentFolderPk,name:e.md.path},label:"Path"},null,8,["value"])])]),m("section",tl,[s(n,{value:e.md.country,label:"Country"},null,8,["value"]),s(n,{value:e.md.language,label:"Language"},null,8,["value"])]),m("section",al,[s(h,{values:l.titledIdentifiers,label:"Identifiers"},null,8,["values"])]),m("section",ll,[s(n,{value:e.md.summary,label:"Summary"},null,8,["value"]),s(n,{value:e.md.review,label:"Review"},null,8,["value"])]),m("section",sl,[s(n,{value:e.md.communityRating,label:"Community Rating"},null,8,["value"]),s(n,{value:e.md.criticalRating,label:"Critical Rating"},null,8,["value"]),s(n,{value:e.md.ageRating,label:"Age Rating"},null,8,["value"])]),m("section",nl,[s(h,{values:e.md.genres,label:"Genres"},null,8,["values"]),s(h,{values:e.md.characters,label:"Characters"},null,8,["values"]),s(h,{values:e.md.teams,label:"Teams"},null,8,["values"]),s(h,{values:e.md.locations,label:"Locations"},null,8,["values"]),s(h,{values:e.md.seriesGroups,label:"Series Groups"},null,8,["values"]),s(h,{values:e.md.stories,label:"Stories"},null,8,["values"]),s(h,{values:e.md.storyArcNumbers,label:"Story Arcs"},null,8,["values"]),s(h,{values:e.md.tags,label:"Tags"},null,8,["values"])]),m("section",rl,[s(V,{value:e.md.contributors},null,8,["value"])]),m("section",il,[s(n,{value:e.md.notes,label:"Notes"},null,8,["value"])]),m("section",ol,[s(n,{value:e.md.tagger,label:"Tagger"},null,8,["value"]),s(n,{value:e.md.scanInfo,label:"Scan"},null,8,["value"])])]),m("footer",ul,[a.group==="c"?(d(),T(ne,{key:0,id:"downloadButton",title:"Download Comic Archive",onClick:l.download},{default:C(()=>[a.group==="c"?(d(),T(ae,{key:0},{default:C(()=>[E(B(r.mdiDownload),1)]),_:1})):R("",!0),E(" Download ")]),_:1},8,["onClick"])):R("",!0),l.isReadButtonShown?(d(),T(ne,{key:1,to:l.readerRoute,title:"Read Comic",disabled:!l.isReadButtonEnabled},{default:C(()=>[s(ae,null,{default:C(()=>[E(B(l.readButtonIcon),1)]),_:1}),E(" Read ")]),_:1},8,["to","disabled"])):R("",!0),m("span",dl,[s(o,{class:"closeButton",title:"Close Metadata (esc)",size:"x-large",onClick:t[2]||(t[2]=p=>r.dialog=!1)})])])],32)):(d(),w("div",cl,[s(o,{class:"closeButton",title:"Close Metadata (esc)",onClick:t[4]||(t[4]=p=>r.dialog=!1)}),ml,s(y,{"model-value":r.progress,indeterminate:r.progress>=100,class:"placeholder"},null,8,["model-value","indeterminate"])]))]),_:1},8,["modelValue"])}const gl=U(za,[["render",vl],["__scopeId","data-v-42e29afa"]]);export{aa as N,Oe as P,bl as _,pl as a,fl as b,gl as c,Ae as d,$a as g,va as p,ra as t};
