import{_ as A,m as B,a as k,u as c,b as I,s as L,N,c as v,o as a,d as o,e as p,V,f as u,g as n,w as r,h as C,F as T,t as m,i as d,j as g,k as w,r as O,l as h,n as S,p as P,q as E,v as M,x as F,y as $,z as j,A as z,B as D,C as x,D as f,E as R}from"./admin-eKzY3vzh.js";const U={name:"AdminStatusList",components:{CloseButton:A},data(){return{mdiCloseCircleOutline:B}},computed:{...k(c,{librarianStatuses:e=>e.librarianStatuses,show:e=>e.librarianStatuses.length>0})},created(){this.load()},methods:{...I(c,["loadTable","librarianTask"]),showComplete:e=>Number.isInteger(e.complete),indeterminate:e=>!e.preactive&&(!e.total||!Number.isInteger(e.complete)),progress(e){return e.preactive||self.indeterminate?0:100*+e.complete/+e.total},load(){this.loadTable("LibrarianStatus")},clear(){this.librarianTask("librarian_clear_status","")},title(e){return L[e.statusType]},nf(e){return Number.isInteger(e)?N.format(e):"?"}}},q=e=>(P("data-v-af1a8109"),e=e(),E(),e),G={key:0},H=q(()=>g("h4",null,"Librarian Tasks",-1)),J={nav:"",class:"statusItem"},K={class:"statusItemTitle"},Q={key:0,class:"statusItemSubtitle"},W={key:1,class:"statusItemSubtitle"},X={key:0};function Y(e,l,i,y,_,t){const b=A;return a(),o(T,null,[e.show?(a(),p(V,{key:0})):u("",!0),n(S,{onClick:t.load},{default:r(()=>[n(C,null,{default:r(()=>[e.show?(a(),o("div",G,[n(b,{id:"clearButton",title:"Clear Librarian Statuses",size:"small",onClick:t.clear},null,8,["onClick"]),H,(a(!0),o(T,null,O(e.librarianStatuses,s=>(a(),p(C,{key:s.statusType},{default:r(()=>[g("div",J,[g("div",K,[d(m(t.title(s))+" ",1),s.subtitle?(a(),o("div",Q,m(s.subtitle),1)):u("",!0),t.showComplete(s)||Number.isInteger(s.total)?(a(),o("div",W,[t.showComplete(s)?(a(),o("span",X,m(t.nf(s.complete))+" / ",1)):u("",!0),d(" "+m(t.nf(s.total)),1)])):u("",!0)]),n(w,{indeterminate:t.indeterminate(s),"model-value":t.progress(s),bottom:""},null,8,["indeterminate","model-value"])])]),_:2},1024))),128))])):(a(),p(h,{key:1,id:"noTasksRunning"},{default:r(()=>[d(" No librarian tasks running ")]),_:1}))]),_:1})]),_:1},8,["onClick"])],64)}const Z=v(U,[["render",Y],["__scopeId","data-v-af1a8109"]]),ee={name:"AdminMenu",components:{AdminStatusList:Z},props:{menu:{type:Boolean,default:!0}},data(){return{mdiBookAlert:M,mdiOpenInNew:F,mdiDatabaseEyeOutline:$,mdiCogOutline:j}},computed:{...z(D,["isUserAdmin"]),...k(c,["unseenFailedImports"])},methods:{...I(c,["clearFailedImports","librarianTask"])}},te={key:0},ae={key:0};function se(e,l,i,y,_,t){const b=x("AdminStatusList");return e.isUserAdmin?(a(),o("div",te,[n(S,{onClick:l[0]||(l[0]=s=>e.librarianTask("poll"))},{default:r(()=>[n(h,null,{default:r(()=>[n(f,null,{default:r(()=>[d(m(_.mdiDatabaseEyeOutline),1)]),_:1}),d("Poll All Libraries")]),_:1})]),_:1}),i.menu?(a(),o("div",ae,[n(S,{to:{name:"admin"}},{default:r(()=>[n(h,null,{default:r(()=>[n(f,null,{default:r(()=>[d(m(_.mdiCogOutline),1)]),_:1}),d("Admin Panel "),e.unseenFailedImports?(a(),p(f,{key:0,id:"failedImportsIcon",title:"New Failed Imports"},{default:r(()=>[d(m(_.mdiBookAlert),1)]),_:1})):u("",!0)]),_:1})]),_:1})])):u("",!0),n(b)])):u("",!0)}const ne=v(ee,[["render",se],["__scopeId","data-v-1cce8cdb"]]),de=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"})),re={name:"AdminSettingsButtonProgress",computed:{...k(c,["librarianStatuses"]),progressEnabled:function(){return this.librarianStatuses.length>0},progress:function(){let e=0,l=0;if(!(!this.librarianStatuses||this.librarianStatuses.length===0)){for(const i of this.librarianStatuses){if(i.total===null||i.total===void 0||i.complete===void 0)return;e+=+i.complete,l+=+i.total}if(!(l<=0))return 100*e/l}}},created(){this.loadTable("LibrarianStatus")},methods:{...I(c,["loadTable"])}};function ie(e,l,i,y,_,t){return t.progressEnabled?(a(),p(R,{key:0,indeterminate:t.progress==null,"model-value":t.progress,class:"progress",size:"36","aria-label":"`Librarian tasks in progress ${Math.round(progress)}%`"},null,8,["indeterminate","model-value"])):u("",!0)}const le=v(re,[["render",ie],["__scopeId","data-v-8db54809"]]),ue=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"}));export{de as a,ue as b};
