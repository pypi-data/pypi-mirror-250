"use strict";(self.webpackChunkjupyterlab_unianalytics_telemetry=self.webpackChunkjupyterlab_unianalytics_telemetry||[]).push([[622],{622:(e,t,s)=>{let i,n;s.r(t),s.d(t,{default:()=>E,disabledNotebooksSignaler:()=>A,isDashboardExtensionInstalled:()=>N,schemaIcon:()=>j}),i="https://api.unianalytics.ch/send/",n="wss://ax5pzl8bwk.execute-api.eu-north-1.amazonaws.com/production/";const o="jupyterlab_unianalytics_telemetry",l="SendExtension",a="unianalytics-notebook-user-ids",c="unianalytics";var d,r;!function(e){e.notebookId=`${c}_notebook_id`,e.instanceId=`${c}_instance_id`,e.cellMapping=`${c}_cell_mapping`}(d||(d={})),function(e){e.dashboardOpenChat=`${o}:unianalytics-open-chat`}(r||(r={}));var h=s(539),p=s(83),_=s(901);class u{static setJupyterVersion(e){u._jupyterVersion=e}static checkJupyterVersionSet(){if(null===u._jupyterVersion)throw new Error("JupyterLab version is not set in CompatibilityManager before trying to access it.")}}u._jupyterVersion=null,u.getMetadataComp=(e,t)=>{var s;return u.checkJupyterVersionSet(),4===u._jupyterVersion?null==e?void 0:e.getMetadata(t):null===(s=null==e?void 0:e.metadata)||void 0===s?void 0:s.get(t)},u.setMetadataComp=(e,t,s)=>{var i;u.checkJupyterVersionSet(),4===u._jupyterVersion?null==e||e.setMetadata(t,s):null===(i=null==e?void 0:e.metadata)||void 0===i||i.set(t,s)},u.getCellIdsComp=e=>(u.checkJupyterVersionSet(),Array.from({length:e.length},((t,s)=>e.get(s).id)));const g=()=>{const e=document.cookie.split(";");for(const t of e){const[e,s]=t.split("=").map((e=>e.trim()));if(e===a)return s}return null},m=e=>{let t=0;if("string"==typeof e)t=e.length;else if(Array.isArray(e))for(const s of e)t+=s.length;else for(const s in e)t+=JSON.stringify(e[s]).length;return t};class C{constructor(){this._socket=null,this._ongoingConnectionInfo=null,this._pingInterval=54e4,this._pingTimer=null}_createSocket(e){this._socket=new WebSocket(`wss://ax5pzl8bwk.execute-api.eu-north-1.amazonaws.com/production/?conType=STUDENT&nbId=${e.notebookId}&usrId=${e.instanceId}`),this._socket.addEventListener("open",(()=>{console.log("WebSocket connection opened for",e),this._startPingTimer()})),this._socket.addEventListener("message",(e=>{const t=JSON.parse(e.data);t.action,console.log("Received message from server:",t)})),this._socket.addEventListener("close",(t=>{console.log("WebSocket connection closed for ",e,t),this._stopPingTimer()})),this._socket.addEventListener("error",(e=>{console.error("WebSocket error",e)}))}establishSocketConnection(e){this._closeSocketConnection(),this._ongoingConnectionInfo=e,e&&this._createSocket(e)}_closeSocketConnection(){this._socket&&this._socket.close(),this._socket=null}terminateSocketConnection(){this._closeSocketConnection(),this._ongoingConnectionInfo=null}_startPingTimer(){this._pingTimer=window.setInterval((()=>{this._socket&&this._socket.readyState===WebSocket.OPEN&&this._socket.send('{ "action":"ping" }')}),this._pingInterval)}_stopPingTimer(){this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=null)}}class b{constructor(e){this._isDisposed=!1;const t=e.context.model,s=u.getMetadataComp(t,d.notebookId);if(s){const e=g(),t=e?JSON.parse(e):{};if(!t[s]){const e=crypto.randomUUID();t[s]=e,i=JSON.stringify(t),document.cookie=`${a}=${i}; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/`}}var i}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,_.Signal.clearData(this))}}class k{constructor(e){this._onPanelDisposed=e=>{e.context.model.cells.changed.disconnect(this._onCellsAltered,this)},this._hasCellListChanged=(e,t)=>{if(e.length!==t.length)return!0;for(let s=0;s<e.length;s++)if(e[s]!==t[s])return!0;return!1},this._updateCellMapping=e=>{var t,s;const i=u.getMetadataComp(null===(t=this._panel)||void 0===t?void 0:t.model,d.cellMapping);if(!i)return;const n=[];for(const[t,s]of e.entries()){const e=i.find((([e,t])=>e===s));if(e)n.push(e);else if(t>0){const e=n[t-1];n.push([s,e[1]])}else{const e=i[0];n.push([s,e[1]])}}u.setMetadataComp(null===(s=this._panel)||void 0===s?void 0:s.model,d.cellMapping,n)},this._onCellsAltered=e=>{var t;const s=u.getCellIdsComp(e);(null===(t=this._panel)||void 0===t?void 0:t.context.isReady)&&this._hasCellListChanged(s,this._cellIdList)&&this._updateCellMapping(s),this._cellIdList=s},this._isDisposed=!1,this._cellIdList=[],this._panel=e,e&&!e.isDisposed&&u.getMetadataComp(e.context.model,d.notebookId)&&u.getMetadataComp(e.context.model,d.cellMapping)&&(this._cellIdList=u.getCellIdsComp(e.context.model.cells),e.context.model.cells.changed.connect(this._onCellsAltered,this),e.disposed.connect(this._onPanelDisposed,this))}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,this._panel=null,this._cellIdList=[],_.Signal.clearData(this))}}var D=s(576),v=s(930),I=s(956);const f=(e,t)=>{const s=JSON.stringify(e),i="https://api.unianalytics.ch/send/"+t;s.length>1048576?console.log("Payload size exceeds limit of 1 Mb"):(console.log("Posting to "+t+" :\n",e),fetch(i,{method:"POST",headers:{"Content-Type":"application/json","X-Nonce":crypto.randomUUID()},body:s}).then((e=>{e.json().then((e=>console.log(e)))})))},y=e=>{f(e,"alter")};class S{constructor(e,t){this._isDisposed=!1,this._panel=e,this._notebookId=t.notebookId,this._instanceId=t.instanceId,D.NotebookActions.executed.connect(this._onCellExecuted,this),e.disposed.connect((()=>D.NotebookActions.executed.disconnect(this._onCellExecuted,this)))}_onCellExecuted(e,t){var s,i,n,o;const{notebook:l,cell:a}=t;var c,r;if(l===this._panel.content)if(a instanceof I.CodeCell){const e=u.getMetadataComp(a.model,"execution");if(e&&v.JSONExt.isObject(e)){const t=e["shell.execute_reply.started"]||e["iopub.execute_input"],n=e["shell.execute_reply"];if((!n||e["iopub.execute_input"])&&n&&t){const e=a.model.outputs.toJSON(),o=this._panel.model,{status:l,cell_output_length:c}=(e=>{let t=0,s="ok";for(const i of e){const e=i.output_type;if("stream"===e){const e=i.text;t+=m(e)}else"error"===e?(s="error",t+=i.evalue.length):t+="execute_result"===e||"display_data"===e?m(i.data):0}return{status:s,cell_output_length:t}})(e),h=null===(i=null===(s=u.getMetadataComp(o,d.cellMapping))||void 0===s?void 0:s.find((([e])=>e===a.model.id)))||void 0===i?void 0:i[1];h&&(r={notebook_id:this._notebookId,instance_id:this._instanceId,language_mimetype:u.getMetadataComp(o,"language_info").mimetype||"text/plain",cell_id:a.model.id,orig_cell_id:h,t_start:t,t_finish:n,status:l,cell_input:a.model.sharedModel.getSource(),cell_output_model:e,cell_output_length:c},f(r,"exec/code"))}}}else if(a instanceof I.MarkdownCell){const e=null===(o=null===(n=u.getMetadataComp(this._panel.model,d.cellMapping))||void 0===n?void 0:n.find((([e])=>e===a.model.id)))||void 0===o?void 0:o[1];e&&(c={notebook_id:this._notebookId,instance_id:this._instanceId,cell_id:a.model.id,orig_cell_id:e,time:(new Date).toISOString(),cell_content:a.model.sharedModel.getSource()},f(c,"exec/markdown"))}}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,_.Signal.clearData(this))}}class w{constructor(e,t){this._onCellsAltered=e=>{const t=u.getCellIdsComp(e),s=t.filter((e=>!this._cellIdList.includes(e))),i=this._cellIdList.filter((e=>!t.includes(e)));for(const e of s)y({notebook_id:this._notebookId,instance_id:this._instanceId,cell_id:e,alteration_type:"ADD",time:(new Date).toISOString()});for(const e of i)y({notebook_id:this._notebookId,instance_id:this._instanceId,cell_id:e,alteration_type:"REMOVE",time:(new Date).toISOString()});this._cellIdList=t},this._onPanelDisposed=e=>{e.context.model.cells.changed.disconnect(this._onCellsAltered,this)},this._isDisposed=!1,this._cellIdList=[],this._notebookId=t.notebookId,this._instanceId=t.instanceId,this._cellIdList=u.getCellIdsComp(e.context.model.cells),e.context.model.cells.changed.connect(this._onCellsAltered,this),e.disposed.connect(this._onPanelDisposed,this)}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,this._cellIdList=[],_.Signal.clearData(this))}}class x{constructor(e,t){this._onContentDisposed=e=>{e.activeCellChanged.disconnect(this._onCellChanged,this),e.disposed.disconnect(this._onContentDisposed,this)},this._onCellChanged=(e,t)=>{this._sendCellClick("OFF"),this._setActiveCellAndOrigCellId(t),this._sendCellClick("ON")},this._setActiveCellAndOrigCellId=e=>{var t,s,i;this._lastActiveCellId=null==e?void 0:e.model.sharedModel.getId(),this._lastActiveCellId?this._lastOrigCellId=null===(i=null===(s=u.getMetadataComp(null===(t=this._panel)||void 0===t?void 0:t.model,d.cellMapping))||void 0===s?void 0:s.find((([e])=>e===this._lastActiveCellId)))||void 0===i?void 0:i[1]:this._lastOrigCellId=null},this._sendCellClick=e=>{if(this._lastActiveCellId){let s=null;"ON"===e?(this._cellStart=new Date,s=null):s=((new Date).getTime()-this._cellStart.getTime())/1e3,this._lastOrigCellId&&(t={notebook_id:this._notebookId,instance_id:this._instanceId,cell_id:this._lastActiveCellId,orig_cell_id:this._lastOrigCellId,click_type:e,time:(new Date).toISOString(),click_duration:s},f(t,"clickevent/cell"))}var t},this._sendNotebookClick=e=>{let t=null;var s;"ON"===e?(this._notebookStart=new Date,t=null):t=((new Date).getTime()-this._notebookStart.getTime())/1e3,s={notebook_id:this._notebookId,instance_id:this._instanceId,click_type:e,time:(new Date).toISOString(),click_duration:t},f(s,"clickevent/notebook")},this._isDisposed=!1,this._lastActiveCellId=null,this._lastOrigCellId=null,this._notebookStart=new Date,this._cellStart=new Date,this._panel=e,this._notebookId=t.notebookId,this._instanceId=t.instanceId,this._sendNotebookClick("ON"),this._onCellChanged(e.content,e.content.activeCell),e.content.activeCellChanged.connect(this._onCellChanged,this),e.content.disposed.connect(this._onContentDisposed,this)}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._sendNotebookClick("OFF"),this._sendCellClick("OFF"),this._isDisposed=!0,this._lastActiveCellId=null,_.Signal.clearData(this))}}var M=s(178);class O{constructor(e,t){this._ongoingContextId="",this._instanceInitializerDisposable=null,this._cellMappingDisposable=null,this._executionDisposable=null,this._alterationDisposable=null,this._focusDisposable=null,this._panel=null,this._isDataCollectionEnabled=e.get(l).composite,e.changed.connect(this._onSettingsChanged.bind(this)),A.valueChanged.connect(this._addOptionalTrackers.bind(this)),this._settings=e,this._dialogShownSettings=t,this._websocketManager=new C}_onSettingsChanged(e){const t=this._isDataCollectionEnabled;this._isDataCollectionEnabled=e.get(l).composite,this._isDataCollectionEnabled!==t&&this._addOptionalTrackers()}get panel(){return this._panel}set panel(e){if(this._panel===e)return;if(this._panel&&this._panel.disposed.disconnect(this._onPanelDisposed,this),this._disposeFromAllTrackers(),this._panel=e,this._panel&&this._panel.disposed.connect(this._onPanelDisposed,this),!this._panel)return;const t=crypto.randomUUID();this._ongoingContextId=t,this._panel.sessionContext.ready.then((()=>{this._ongoingContextId===t&&this._panel&&!this._panel.isDisposed&&this._addAllTrackers()}))}_addAllTrackers(){this._panel&&this._panel.sessionContext.isReady&&(this._instanceInitializerDisposable=new b(this._panel),this._cellMappingDisposable=new k(this._panel),this._addOptionalTrackers())}_addOptionalTrackers(){if(this._disposeFromOptionalTrackers(),this._panel&&this._panel.sessionContext.isReady){const e=(e=>{if(e&&!e.isDisposed){const t=u.getMetadataComp(e.context.model,d.notebookId),s=u.getMetadataComp(e.context.model,d.cellMapping);if(t&&s){if(N&&(null===A.value||A.value.includes(t)))return null;const e=(e=>{const t=g();return t?JSON.parse(t)[e]:null})(t);if(e)return{notebookId:t,instanceId:e}}}return null})(this._panel);e&&this._showConsentDialogPromise().then((()=>{this._panel&&!this._panel.isDisposed&&this._isDataCollectionEnabled&&(this._focusDisposable=new x(this._panel,e),this._executionDisposable=new S(this._panel,e),this._alterationDisposable=new w(this._panel,e),this._websocketManager.establishSocketConnection(e))}))}}async _showConsentDialogPromise(){if(!this._dialogShownSettings.get("DialogShown").composite){const e=await(0,M.showDialog)({title:"Unianalytics Data",hasClose:!1,body:"Enable anonymous collection of interaction data in specific notebooks to make it easier for your teacher(s) to support your learning?",buttons:[M.Dialog.okButton({label:"Yes"}),M.Dialog.cancelButton({label:"No"})]});await this._dialogShownSettings.set("DialogShown",!0);let t=!1;e.button.accept?(await this._settings.set(l,!0),t=!0):(await this._settings.set(l,!1),t=!1),this._isDataCollectionEnabled=t}}_disposeFromAllTrackers(){this._instanceInitializerDisposable&&(this._instanceInitializerDisposable.dispose(),this._instanceInitializerDisposable=null),this._cellMappingDisposable&&(this._cellMappingDisposable.dispose(),this._cellMappingDisposable=null),this._disposeFromOptionalTrackers()}_disposeFromOptionalTrackers(){this._websocketManager.terminateSocketConnection(),this._executionDisposable&&(this._executionDisposable.dispose(),this._executionDisposable=null),this._alterationDisposable&&(this._alterationDisposable.dispose(),this._alterationDisposable=null),this._focusDisposable&&(this._focusDisposable.dispose(),this._focusDisposable=null)}_onPanelDisposed(e){this._disposeFromAllTrackers(),this.panel=null}}function T(e,t){const s=e.currentWidget;if(s)if(s instanceof D.NotebookPanel){const e=s;t.panel=e}else t.panel=null}const j=new p.LabIcon({name:`${o}:schema-icon`,svgstr:'<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN"\n "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg version="1.0" xmlns="http://www.w3.org/2000/svg"\n width="1763.000000pt" height="1611.000000pt" viewBox="0 0 1763.000000 1611.000000"\n preserveAspectRatio="xMidYMid meet">\n\n<g transform="translate(0.000000,1611.000000) scale(0.100000,-0.100000)"\nfill="#000000" stroke="none">\n<path fill="#616161" class="jp-custom-icon jp-icon3 jp-icon-selectable" d="M8220 15781 c-122 -18 -249 -116 -311 -239 l-34 -67 -5 -1265 -5\n-1265 -455 -5 c-452 -5 -455 -5 -498 -28 -110 -59 -172 -164 -172 -290 0 -121\n-76 -25 1105 -1398 812 -943 748 -872 819 -914 32 -19 58 -25 128 -28 79 -4\n93 -2 140 22 29 14 67 39 85 55 25 23 1067 1232 1298 1506 33 39 161 189 285\n333 124 144 236 283 249 309 36 70 35 160 -3 237 -35 72 -75 111 -146 145\nl-55 26 -437 3 -438 3 0 1233 c0 785 -4 1253 -10 1286 -16 82 -57 159 -119\n220 -67 67 -146 108 -232 120 -71 11 -1118 11 -1189 1z"/>\n<path fill="#616161" class="jp-custom-icon jp-icon3 jp-icon-selectable" d="M1264 12910 c-103 -21 -130 -44 -573 -489 -396 -399 -425 -431 -459\n-500 -33 -68 -36 -81 -36 -167 0 -84 3 -98 34 -161 30 -63 92 -128 921 -958\n489 -490 889 -897 889 -905 0 -8 -139 -154 -309 -324 -284 -286 -310 -316\n-330 -369 -54 -147 7 -310 141 -376 71 -36 81 -38 258 -51 74 -6 214 -17 310\n-25 96 -8 238 -19 315 -25 77 -5 158 -12 180 -15 22 -4 101 -10 175 -15 74 -5\n182 -14 240 -19 58 -6 195 -17 305 -26 110 -9 247 -20 305 -26 58 -5 164 -14\n235 -19 72 -5 180 -14 240 -20 61 -6 164 -12 230 -13 105 -1 125 2 161 21 66\n34 101 69 142 140 l37 67 -2 160 c-1 143 -9 270 -44 695 -5 69 -14 193 -19\n275 -6 83 -16 242 -25 355 -36 505 -46 645 -55 790 -6 85 -15 196 -20 247 -6\n51 -10 125 -10 165 0 88 -21 191 -50 247 -33 66 -100 123 -168 145 -79 25\n-170 19 -234 -15 -30 -16 -153 -129 -353 -326 -209 -206 -311 -301 -320 -295\n-7 4 -409 400 -892 881 -569 564 -899 885 -934 907 -78 49 -180 64 -285 44z"/>\n<path fill="#616161" class="jp-custom-icon jp-icon3 jp-icon-selectable" d="M16170 12906 c-121 -25 -117 -21 -1051 -959 -711 -715 -879 -878\n-895 -873 -10 3 -149 137 -309 297 -159 160 -303 300 -318 311 -15 11 -51 26\n-80 34 -118 31 -214 7 -298 -76 -79 -79 -93 -125 -113 -380 -9 -113 -21 -252\n-27 -310 -5 -58 -14 -163 -19 -235 -5 -71 -16 -215 -25 -320 -24 -291 -45\n-547 -55 -685 -5 -69 -14 -177 -20 -240 -30 -328 -54 -647 -54 -735 0 -88 27\n-153 90 -212 77 -74 118 -86 274 -84 74 0 167 5 205 11 39 5 138 14 220 20 83\n6 231 17 330 25 427 34 568 45 695 55 74 5 187 14 250 20 198 18 360 31 511\n40 80 5 177 14 215 20 38 5 103 10 145 10 124 0 222 37 297 111 101 100 125\n244 61 370 -10 20 -120 135 -245 255 -126 120 -259 249 -297 286 l-69 67 20\n28 c11 15 406 413 878 883 490 489 870 876 889 905 47 75 65 132 65 211 0 133\n-45 217 -192 359 -51 50 -232 227 -403 394 -345 337 -404 382 -515 400 -76 13\n-87 12 -160 -3z"/>\n<path fill="#616161" class="jp-custom-icon jp-icon3 jp-icon-selectable" d="M8375 8590 c-228 -8 -598 -37 -830 -65 -1245 -146 -2171 -506 -2432\n-945 -39 -64 -65 -161 -65 -235 1 -380 502 -732 1383 -973 624 -171 1379 -266\n2209 -278 699 -11 1303 31 1885 131 1018 174 1727 479 1977 850 249 371 -45\n775 -780 1069 -578 231 -1365 383 -2258 436 -234 14 -834 19 -1089 10z"/>\n<path fill="#616161" class="jp-custom-icon jp-icon3 jp-icon-selectable" d="M5050 5241 c0 -569 3 -836 11 -873 28 -130 117 -250 289 -389 111\n-90 274 -183 470 -270 415 -183 1027 -333 1690 -414 213 -26 415 -43 786 -65\n221 -13 833 -13 1039 0 372 24 467 31 600 45 263 27 377 42 635 85 333 55 788\n173 1055 273 548 205 879 460 950 732 13 51 15 175 15 877 0 450 -2 818 -5\n818 -2 0 -47 -25 -100 -55 -229 -132 -644 -302 -955 -390 -503 -142 -1099\n-250 -1630 -295 -69 -6 -172 -15 -230 -20 -258 -24 -782 -33 -1210 -21 -501\n13 -706 28 -1180 87 -163 21 -461 71 -590 99 -41 10 -95 21 -120 26 -65 13\n-368 89 -415 104 -22 7 -94 29 -160 50 -291 89 -672 250 -825 347 -30 19 -70\n43 -87 52 l-33 17 0 -820z m6030 -458 c119 -53 200 -155 220 -276 20 -127 -12\n-231 -98 -315 -121 -117 -298 -136 -443 -46 -189 117 -225 380 -75 542 43 46\n79 71 145 99 47 20 69 23 131 20 45 -3 93 -12 120 -24z"/>\n<path fill="#616161" class="jp-custom-icon jp-icon3 jp-icon-selectable" d="M12505 3167 c-94 -59 -379 -198 -515 -252 -656 -259 -1552 -428\n-2515 -476 -276 -13 -1032 -13 -1310 0 -520 26 -1033 88 -1450 175 -38 8 -104\n21 -145 30 -90 18 -365 88 -435 109 -320 100 -453 148 -615 219 -153 68 -315\n149 -395 198 -36 22 -68 40 -70 40 -3 0 -4 -381 -3 -847 l3 -848 23 -57 c153\n-379 846 -735 1802 -928 146 -30 192 -38 430 -74 900 -138 2028 -141 2950 -10\n276 39 585 97 742 138 51 14 127 34 168 44 233 61 561 182 760 281 301 151\n509 321 598 490 64 120 63 112 60 1007 l-3 811 -80 -50z m-1408 -1268 c69 -33\n144 -101 173 -158 46 -91 44 -239 -5 -329 -74 -137 -229 -218 -367 -192 -260\n50 -391 334 -251 547 102 155 287 209 450 132z"/>\n</g>\n</svg>\n'}),A=new class{constructor(){this._value=null,this._valueChanged=new _.Signal(this)}set value(e){e!==this._value&&(this._value=e,this._valueChanged.emit(e))}get value(){return this._value}get valueChanged(){return this._valueChanged}};let N=!1;const E={id:`${o}:plugin`,autoStart:!0,requires:[h.ISettingRegistry],activate:(e,t)=>{console.log(`JupyterLab extension ${o} is activated!`),N=e.listPlugins().some((e=>e.includes("jupyterlab_unianalytics_dashboard"))),console.log("Is dashboard extension also installed ?",N),N&&window.addEventListener("message",(e=>{e.origin===window.origin&&e.data&&"unianalytics"===e.data.identifier&&(A.value=e.data.authNotebooks)}));const s="3.1.0",i=e.version.match(/[0-9]+/g);if(i&&((e,t)=>{const s=e.split(/[^0-9]+/).map(Number),i=t.split(/[^0-9]+/).map(Number);for(let e=0;e<Math.min(s.length,i.length);e++){const t=s[e],n=i[e];if(t!==n)return t-n}const n=e.replace(/[0-9]+/g,""),o=t.replace(/[0-9]+/g,"");return n.localeCompare(o)})(e.version,s)>=0){const s=parseInt(i[0]);u.setJupyterVersion(s),(async(e,t)=>{t.load("@jupyterlab/notebook-extension:tracker").then((e=>{e.set("recordTiming",!0)})).catch((e=>console.log(`${o}: Could not force cell execution metadata recording: ${e}`)));try{const[s,i]=await Promise.all([t.load(`${o}:settings`),t.load(`${o}:dialogShownSettings`)]),n=new O(s,i),l=e.shell;l&&l.currentChanged.connect((()=>T(l,n))),e.restored.then((()=>{T(l,n)}))}catch(e){console.log(`${o}: Could not load settings, error: ${e}`)}})(e,t)}else console.log(`Use a more recent version of JupyterLab (>=${s})`)}}}}]);