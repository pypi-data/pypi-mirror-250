"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[648],{96451:function(e,n,i){var t,r=i(82548),l=(i(4519),i(16980)),o=i(2556);n.Z=function(e){var n,a=e.endpointFrgmt,s=(0,l.useFragment)(void 0!==t?t:t=i(58393),a),u="default";switch(null===s||void 0===s||null===(n=s.status)||void 0===n?void 0:n.toUpperCase()){case"RUNNING":case"HEALTHY":u="success"}return(0,o.jsx)(r.Z,{color:u,children:null===s||void 0===s?void 0:s.status})}},76587:function(e,n,i){var t,r=i(1413),l=i(29439),o=i(44925),a=i(43255),s=i(87760),u=i(50164),d=i(77758),c=i(99277),m=i(44036),v=i(57054),f=i(66653),g=(i(4519),i(81748)),p=i(16980),y=i(2556),h=["onRequestClose","endpointFrgmt"];n.Z=function(e){var n=e.onRequestClose,S=e.endpointFrgmt,x=(0,o.Z)(e,h),k=m.Z.useToken().token,Z=(0,s.Dj)(),b=(0,g.$G)().t,_=v.Z.useForm(),j=(0,l.Z)(_,1)[0],C=(0,p.useFragment)(void 0!==t?t:t=i(56326),S),F=(0,u.Y)({mutationFn:function(e){var n={to:e.desired_session_count};return(0,a.Lc)({method:"POST",url:"/services/".concat(null===C||void 0===C?void 0:C.endpoint_id,"/scale"),body:n,client:Z})}});return(0,y.jsx)(d.Z,(0,r.Z)((0,r.Z)({style:{zIndex:1e4},destroyOnClose:!0,onOk:function(e){j.validateFields().then((function(e){F.mutate(e,{onSuccess:function(){console.log("service updated"),n(!0)},onError:function(e){console.log(e)}})})).catch((function(e){console.log(e)}))},onCancel:function(){n()},okButtonProps:{loading:F.isLoading},title:b("modelService.EditModelService")},x),{},{children:(0,y.jsx)(c.Z,{direction:"row",align:"stretch",justify:"around",children:(0,y.jsx)(v.Z,{form:j,preserve:!1,validateTrigger:["onChange","onBlur"],initialValues:{desired_session_count:null===C||void 0===C?void 0:C.desired_session_count},style:{marginBottom:k.marginLG,marginTop:k.margin},children:(0,y.jsx)(v.Z.Item,{name:"desired_session_count",label:b("modelService.DesiredSessionCount"),rules:[{pattern:/^[0-9]+$/,message:b("modelService.OnlyAllowsNonNegativeIntegers")}],children:(0,y.jsx)(f.Z,{type:"number",min:0})})})})}))}},58393:function(e,n,i){i.r(n);var t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EndpointStatusTagFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],type:"Endpoint",abstractKey:null,hash:"3b31efa50b55edddcb210b59003dc479"};n.default=t},56326:function(e,n,i){i.r(n);var t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelServiceSettingModal_endpoint",selections:[{alias:null,args:null,kind:"ScalarField",name:"endpoint_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"desired_session_count",storageKey:null}],type:"Endpoint",abstractKey:null,hash:"881f18324b27eba6ff0fcfb83ae241d2"};n.default=t},45648:function(e,n,i){i.r(n),i.d(n,{default:function(){return ve}});var t=i(93433),r=i(29439),l=i(77758),o=i(96451),a=i(99277),s=i(76587),u=i(1413),d=i(44925),c=i(43255),m=i(87760),v=i(1839),f=i(50164),g=i(46228),p=i(15008),y=i(61815),h=i(96732),S=i(57054),x=i(31603),k=i(66653),Z=i(4519),b=i(2556),_=["name","min","max","step","rules","required","inputNumberProps","sliderProps","initialValue","disabled"],j=function(e){var n=e.name,i=e.min,t=e.max,r=e.step,l=e.rules,o=e.required,s=e.inputNumberProps,c=e.sliderProps,m=e.initialValue,v=e.disabled,f=(0,d.Z)(e,_),g=S.Z.useFormInstance();return(0,Z.useEffect)((function(){1===r&&g.getFieldValue(n)%1!==0&&g.setFieldValue(n,Math.round(g.getFieldValue(n)))}),[r,g,n]),(0,b.jsx)(S.Z.Item,(0,u.Z)((0,u.Z)({required:o},f),{},{children:(0,b.jsxs)(a.Z,{direction:"row",gap:"md",children:[(0,b.jsx)(a.Z,{direction:"column",align:"stretch",style:{flex:3},children:(0,b.jsx)(S.Z.Item,{name:n,noStyle:!0,rules:l,initialValue:m,label:f.label,children:(0,b.jsx)(x.Z,(0,u.Z)({max:t,min:i,step:r,disabled:v},c))})}),(0,b.jsx)(a.Z,{style:{flex:2,minWidth:130},align:"stretch",direction:"column",children:(0,b.jsx)(S.Z.Item,{name:n,noStyle:!0,rules:l,initialValue:m,label:f.label,children:(0,b.jsx)(k.Z,(0,u.Z)({max:t,min:i,step:r,onStep:function(e,n){console.log(e,n)},disabled:v},s))})})]})}))},C=i(19427),F=i(32048),T=i.n(F),P=["filter","autoSelectDefault"],I=function(e){var n,i,t=e.filter,l=e.autoSelectDefault,o=(0,d.Z)(e,P),a=(0,m.qh)(),s=(0,c.y3)(),v=(0,m.Kr)("first"),g=(0,r.Z)(v,2),p=g[0],y=g[1],h=(0,f.h)({queryKey:["VFolderSelectQuery",p],queryFn:function(){return s({method:"GET",url:"/folders?group_id=".concat(a.id)})},staleTime:0}).data,S=t?T().filter(h,t):h,x=T().first(S)?{label:null===(n=T().first(S))||void 0===n?void 0:n.name,value:null===(i=T().first(S))||void 0===i?void 0:i.name}:void 0;return(0,Z.useEffect)((function(){var e;l&&x&&(null===(e=o.onChange)||void 0===e||e.call(o,x.value,x))}),[l]),(0,b.jsx)(C.Z,(0,u.Z)((0,u.Z)({showSearch:!0},o),{},{onDropdownVisibleChange:function(e){e&&(0,Z.startTransition)((function(){y()}))},children:T().map(S,(function(e){return(0,b.jsx)(C.Z.Option,{value:null===e||void 0===e?void 0:e.name,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e.id)}))}))},K=i(44036),w=i(88464),D=i(38818),L=i(62708),E=i(53066),q=i(81748),R=["extraP","onRequestClose"],M=function(e){e.extraP;var n,i=e.onRequestClose,t=(0,d.Z)(e,R),o=(0,q.$G)().t,a=K.Z.useToken().token,s=(0,m.Dj)(),x=(0,m.tQ)(),k=S.Z.useForm(),_=(0,r.Z)(k,1)[0],F=(0,v.T6)(),P=(0,r.Z)(F,1)[0],M=S.Z.useWatch(["environments","image"],_),A=_.getFieldValue(["resource","acceleratorType"]),N=T().filter(null===M||void 0===M?void 0:M.resource_limits,(function(e){return!!e&&!T().includes(["cpu","mem","shmem"],e.key)})),V=(null===(n=T().filter(N,(function(e){return T().keys(P).includes(null===e||void 0===e?void 0:e.key)}))[0])||void 0===n?void 0:n.key)||"",z=T().omit(P,["cpu","mem","shmem"]);(0,Z.useEffect)((function(){_.setFieldValue(["resource","accelerator"],O(V).min||0),_.setFieldValue(["resource","acceleratorType"],{value:V,label:h.Ec[V]||"UNIT"})}),[M]);var O=function(e){var n,i=8;switch(e){case"cuda.device":default:i=s._config.maxCUDADevicesPerContainer||i;break;case"cuda.shares":i=s._config.maxCUDASharesPerContainer||i;break;case"rocm.device":i=s._config.maxROCMDevicesPerContainer||i;break;case"tpu.device":i=s._config.maxTPUDevicesPerContainer||i;break;case"ipu.device":i=s._config.maxIPUDevicesPerContainer||i;break;case"atom.device":i=s._config.maxATOMDevicesPerContainer||i;break;case"warboy.device":i=s._config.maxWarboyDevicesPerContainer||i}return{min:parseInt(null===(n=T().filter(N,(function(e){return(null===e||void 0===e?void 0:e.key)===V}))[0])||void 0===n?void 0:n.min),max:i}},U=(0,f.Y)({mutationFn:function(e){var n,i,t,r,l,o="".concat(null===(n=e.environments.image)||void 0===n?void 0:n.registry,"/").concat(null===(i=e.environments.image)||void 0===i?void 0:i.name,":").concat(null===(t=e.environments.image)||void 0===t?void 0:t.tag),a={name:e.serviceName,desired_session_count:e.desiredRoutingCount,image:o,arch:null===(r=e.environments.image)||void 0===r?void 0:r.architecture,group:s.current_group,domain:x,cluster_size:1,cluster_mode:"single-node",open_to_public:e.openToPublic,config:{model:e.vFolderName,model_mount_destination:"/models",environ:{},scaling_group:e.resourceGroup,resources:{cpu:e.cpu,mem:e.mem+"G"}}};if(e.resource.acceleratorType)switch(null===(l=e.resource.acceleratorType)||void 0===l?void 0:l.value){case"cuda.shares":a.config.resources["cuda.shares"]=e.resource.accelerator;break;case"cuda.device":a.config.resources["cuda.device"]=e.resource.accelerator;break;case"rocm.device":a.config.resources["rocm.device"]=e.resource.accelerator;break;case"tpu.device":a.config.resources["tpu.device"]=e.resource.accelerator;break;case"ipu.device":a.config.resources["ipu.device"]=e.resource.accelerator;break;case"warboy.device":a.config.resources["warboy.device"]=e.resource.accelerator}return e.shmem&&e.shmem>0&&(a.config.resource_opts={shmem:e.shmem+"G"}),(0,c.Lc)({method:"POST",url:"/services",body:a,client:s})}});return(0,b.jsx)(l.Z,(0,u.Z)((0,u.Z)({title:o("modelService.StartNewServing"),onOk:function(){_.validateFields().then((function(e){U.mutate(e,{onSuccess:function(){i(!0)},onError:function(e){null!==e&&void 0!==e&&e.message?w.ZP.error(T().truncate(null===e||void 0===e?void 0:e.message,{length:200})):w.ZP.error(o("modelService.FailedToStartService"))}})})).catch((function(e){var n,i,t,r;null!==(n=e.errorFields)&&void 0!==n&&null!==(i=n[0].errors)&&void 0!==i&&i[0]?w.ZP.error(null===(t=e.errorFields)||void 0===t||null===(r=t[0].errors)||void 0===r?void 0:r[0]):w.ZP.error(o("modelService.FormValidationFailed"))}))},onCancel:function(){i()},destroyOnClose:!0,maskClosable:!1,confirmLoading:U.isLoading},t),{},{children:(0,b.jsx)(Z.Suspense,{fallback:(0,b.jsx)(g.Z,{}),children:(0,b.jsxs)(S.Z,{disabled:U.isLoading,form:_,preserve:!1,layout:"vertical",labelCol:{span:12},initialValues:{cpu:1,resource:{accelerator:0},mem:.25,shmem:0,desiredRoutingCount:1},children:[(0,b.jsx)(S.Z.Item,{label:o("modelService.ServiceName"),name:"serviceName",rules:[{pattern:/^(?=.{4,24}$)\w[\w.-]*\w$/,message:o("modelService.ServiceNameRule")},{required:!0}],children:(0,b.jsx)(D.Z,{})}),(0,b.jsx)(S.Z.Item,{name:"resourceGroup",label:o("session.ResourceGroup"),rules:[{required:!0}],children:(0,b.jsx)(y.Z,{autoSelectDefault:!0})}),(0,b.jsx)(S.Z.Item,{name:"openToPublic",label:o("modelService.OpenToPublic"),valuePropName:"checked",children:(0,b.jsx)(L.Z,{})}),(0,b.jsx)(S.Z.Item,{name:"vFolderName",label:o("session.launcher.ModelStorageToMount"),rules:[{required:!0}],children:(0,b.jsx)(I,{filter:function(e){return"model"===e.usage_mode},autoSelectDefault:!0})}),(0,b.jsx)(j,{label:o("modelService.DesiredRoutingCount"),name:"desiredRoutingCount",rules:[{required:!0}],inputNumberProps:{addonAfter:"#"},required:!0}),(0,b.jsxs)(E.Z,{style:{marginBottom:a.margin},children:[(0,b.jsx)(p.Z,{}),(0,b.jsx)(S.Z.Item,{noStyle:!0,shouldUpdate:function(e,n){var i,t,r,l;return(null===(i=e.environments)||void 0===i||null===(t=i.image)||void 0===t?void 0:t.digest)!==(null===(r=n.environments)||void 0===r||null===(l=r.image)||void 0===l?void 0:l.digest)},children:function(e){var n,i,t=null===(n=(0,e.getFieldValue)("environments"))||void 0===n?void 0:n.image;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j,{name:"cpu",label:o("session.launcher.CPU"),tooltip:(0,b.jsx)(q.cC,{i18nKey:"session.launcher.DescCPU"}),min:parseInt((null===(i=T().find(null===t||void 0===t?void 0:t.resource_limits,(function(e){return"cpu"===(null===e||void 0===e?void 0:e.key)})))||void 0===i?void 0:i.min)||"0"),max:s._config.maxCPUCoresPerContainer||128,inputNumberProps:{addonAfter:o("session.launcher.Core")},required:!0,rules:[{required:!0}]}),(0,b.jsx)(j,{name:"mem",label:o("session.launcher.Memory"),tooltip:(0,b.jsx)(q.cC,{i18nKey:"session.launcher.DescMemory"}),max:s._config.maxMemoryPerContainer||1536,min:0,inputNumberProps:{addonAfter:"GiB"},step:.25,required:!0,rules:[{required:!0},function(e){e.getFieldValue;return{validator:function(e,n){var i,r=(0,c.PZ)((null===(i=T().find(null===t||void 0===t?void 0:t.resource_limits,(function(e){return"mem"===(null===e||void 0===e?void 0:e.key)})))||void 0===i?void 0:i.min)||"0B","G");return null!==r&&void 0!==r&&r.number&&(null===r||void 0===r?void 0:r.number)>n?Promise.reject(new Error(o("session.launcher.MinMemory",{size:null===r||void 0===r?void 0:r.numberUnit}))):Promise.resolve()}}}]}),(0,b.jsx)(j,{name:"shmem",label:o("session.launcher.SharedMemory"),tooltip:(0,b.jsx)(q.cC,{i18nKey:"session.launcher.DescSharedMemory"}),max:s._config.maxShmPerContainer||8,min:0,step:.25,inputNumberProps:{addonAfter:"GiB"},required:!0,rules:[{required:!0}]})]})}}),(0,b.jsx)(S.Z.Item,{noStyle:!0,shouldUpdate:function(e,n){var i,t;return(null===(i=e.environments)||void 0===i?void 0:i.environment)!==(null===(t=n.environments)||void 0===t?void 0:t.environment)},children:function(){return(0,b.jsx)(j,{name:["resource","accelerator"],label:o("session.launcher.AIAccelerator"),tooltip:(0,b.jsx)(q.cC,{i18nKey:"session.launcher.DescAIAccelerator"}),sliderProps:{},min:0,max:O(V).max,step:T().endsWith(A,"shares")?.1:1,disabled:N.length<=0,inputNumberProps:{addonAfter:(0,b.jsx)(S.Z.Item,{noStyle:!0,name:["resource","acceleratorType"],initialValue:V,children:(0,b.jsx)(C.Z,{disabled:N.length<=0,suffixIcon:T().size(z)>1?void 0:null,open:T().size(z)>1&&void 0,popupMatchSelectWidth:!1,options:T().map(z,(function(e,n){return{value:n,label:h.Ec[n]||"UNIT",disabled:N.length>0&&!T().find(N,(function(e){return(null===e||void 0===e?void 0:e.key)===n}))}}))})})},required:!0,rules:[{required:!0}]})}})]})]})})}))},A=i(7517),N=i(14634),V=["open","onRequestClose","columns","displayedColumnKeys"],z=function(e){var n=e.open,i=e.onRequestClose,t=e.columns,o=e.displayedColumnKeys,a=(0,d.Z)(e,V),s=S.Z.useForm(),c=(0,r.Z)(s,1)[0],m=(0,q.$G)().t,v=K.Z.useToken().token,f=t.map((function(e){return"string"===typeof e.title?{label:e.title,value:T().toString(e.key)}:"object"===typeof e.title&&"props"in e.title?{label:(n=e.title,Z.Children.map(n.props.children,(function(e){if("string"===typeof e)return e}))),value:T().toString(e.key)}:{label:void 0,value:T().toString(e.key)};var n}));return(0,b.jsx)(l.Z,(0,u.Z)((0,u.Z)({title:m("table.SettingTable"),open:n,destroyOnClose:!0,centered:!0,onOk:function(){c.validateFields().then((function(e){i(e)})).catch((function(){}))},onCancel:function(){i()}},a),{},{children:(0,b.jsxs)(S.Z,{form:c,preserve:!1,initialValues:{selectedColumnKeys:o||f.map((function(e){return e.value}))},layout:"vertical",children:[(0,b.jsx)(S.Z.Item,{name:"searchInput",label:m("table.SelectColumnToDisplay"),style:{marginBottom:0},children:(0,b.jsx)(D.Z,{prefix:(0,b.jsx)(A.Z,{}),style:{marginBottom:v.marginSM},placeholder:m("table.SearchTableColumn")})}),(0,b.jsx)(S.Z.Item,{noStyle:!0,shouldUpdate:function(e,n){return e.searchInput!==n.searchInput},children:function(e){var n=e.getFieldValue,i=n("searchInput")?T().toLower(n("searchInput")):void 0,t=f.map((function(e){return T().toLower(T().toString(e.label)).includes(i||"")?e:(0,u.Z)((0,u.Z)({},e),{},{style:{display:"none"}})}));return(0,b.jsx)(S.Z.Item,{name:"selectedColumnKeys",style:{height:220,overflowY:"auto"},children:(0,b.jsx)(N.Z.Group,{options:t,style:{flexDirection:"column"}})})}})]})}))},O=i(43596),U=i(28501),G=i(83861),B=i(31662),$=i(46951),H=i(69537);var Q=function(e){if(e.id,"undefined"===typeof cancelAnimationFrame)return clearInterval(e.id);cancelAnimationFrame(e.id)};var Y=function(e,n,i){var t=null===i||void 0===i?void 0:i.immediate,r=(0,$.Z)(e),l=(0,Z.useRef)();return(0,Z.useEffect)((function(){if((0,H.hj)(n)&&!(n<0))return t&&r.current(),l.current=function(e,n){if(void 0===n&&(n=0),"undefined"===typeof requestAnimationFrame)return{id:setInterval(e,n)};var i=(new Date).getTime(),t={id:0};return t.id=requestAnimationFrame((function r(){(new Date).getTime()-i>=n&&(e(),i=(new Date).getTime()),t.id=requestAnimationFrame(r)})),t}((function(){r.current()}),n),function(){l.current&&Q(l.current)}}),[n]),(0,Z.useCallback)((function(){l.current&&Q(l.current)}),[])},W=i(53316),J=i(72992),X=function(e){return function(n,i){var t=(0,Z.useRef)(!1);e((function(){return function(){t.current=!1}}),[]),e((function(){if(t.current)return n();t.current=!0}),i)}},ee=X(Z.useEffect);var ne,ie,te=!("undefined"===typeof window||!window.document||!window.document.createElement),re=(ne=function(){return te?localStorage:void 0},function(e,n){var i;void 0===n&&(n={});var t=n.onError,r=void 0===t?function(e){console.error(e)}:t;try{i=ne()}catch(u){r(u)}function l(){try{var t=null===i||void 0===i?void 0:i.getItem(e);if(t)return l=t,(null===n||void 0===n?void 0:n.deserializer)?null===n||void 0===n?void 0:n.deserializer(l):JSON.parse(l)}catch(o){r(o)}var l;return(0,H.mf)(null===n||void 0===n?void 0:n.defaultValue)?null===n||void 0===n?void 0:n.defaultValue():null===n||void 0===n?void 0:n.defaultValue}var o=(0,W.CR)((0,Z.useState)((function(){return l()})),2),a=o[0],s=o[1];return ee((function(){s(l())}),[e]),[a,(0,J.Z)((function(t){var r=(0,H.mf)(t)?t(a):t;if(s(r),(0,H.G7)(r))null===i||void 0===i||i.removeItem(e);else try{null===i||void 0===i||i.setItem(e,function(e){return(null===n||void 0===n?void 0:n.serializer)?null===n||void 0===n?void 0:n.serializer(e):JSON.stringify(e)}(r))}catch(l){console.error(l)}}))]}),le=i(70389),oe=i(92171),ae=i(45110),se=i(49248),ue=i(99517),de=i.n(ue),ce=i(16980),me=i(51843),ve=function(e){e.children;var n=(0,q.$G)().t,u=(0,m.Dj)(),d=K.Z.useToken().token,v=(0,m.qh)(),g=(0,Z.useState)(!1),p=(0,r.Z)(g,2),y=p[0],h=p[1],S=(0,Z.useState)(!1),x=(0,r.Z)(S,2),k=x[0],_=x[1],j=(0,Z.useState)(),C=(0,r.Z)(j,2),F=C[0],P=C[1],I=(0,Z.useState)(!1),w=(0,r.Z)(I,2),D=w[0],L=w[1],E=(0,Z.useState)({current:1,pageSize:100}),R=(0,r.Z)(E,1)[0],A=(0,Z.useTransition)(),N=(0,r.Z)(A,2),V=N[0],$=N[1],H=(0,Z.useState)(!1),Q=(0,r.Z)(H,2),W=Q[0],J=Q[1],X=(0,m.Kr)("initial-fetch"),ee=(0,r.Z)(X,2),ne=ee[0],te=ee[1],ue=(0,Z.useState)("services"),ve=(0,r.Z)(ue,2),fe=ve[0],ge=ve[1],pe=[{title:n("modelService.EndpointName"),dataIndex:"endpoint_id",key:"endpointName",fixed:"left",render:function(e,n){return(0,b.jsx)(me.rU,{to:"/serving/"+e,children:n.name})}},{title:n("modelService.EndpointId"),dataIndex:"endpoint_id",key:"endpoint_id",width:310,render:function(e){return(0,b.jsx)(le.Z.Text,{code:!0,children:e})}},{title:n("modelService.ServiceEndpoint"),dataIndex:"endpoint_id",key:"url",render:function(e,n){return n.url?(0,b.jsx)(le.Z.Link,{copyable:!0,href:n.url,target:"_blank",children:n.url}):"-"}},{title:n("modelService.Controls"),dataIndex:"controls",key:"controls",render:function(e,n){var i,t,r,l;return(0,b.jsxs)(a.Z,{direction:"row",align:"stretch",children:[(0,b.jsx)(oe.ZP,{type:"text",icon:(0,b.jsx)(O.Z,{}),style:n.desired_session_count<0||"destroying"===(null===(i=n.status)||void 0===i?void 0:i.toLowerCase())?void 0:{color:"#29b6f6"},disabled:n.desired_session_count<0||"destroying"===(null===(t=n.status)||void 0===t?void 0:t.toLowerCase()),onClick:function(){L(!0),P(n)}}),(0,b.jsx)(oe.ZP,{type:"text",icon:(0,b.jsx)(U.Z,{style:n.desired_session_count<0||"destroying"===(null===(r=n.status)||void 0===r?void 0:r.toLowerCase())?void 0:{color:d.colorError}}),disabled:n.desired_session_count<0||"destroying"===(null===(l=n.status)||void 0===l?void 0:l.toLowerCase()),onClick:function(){J(!0),P(n)}})]})}},{title:n("modelService.Status"),key:"status",render:function(e,n){return(0,b.jsx)(o.Z,{endpointFrgmt:n})}}].concat((0,t.Z)(u.is_admin?[{title:n("modelService.Owner"),dataIndex:"created_user",key:"session_owner",render:function(e){return e}}]:[]),[{title:n("modelService.CreatedAt"),dataIndex:"created_at",key:"createdAt",render:function(e){return de()(e).format("ll LT")},defaultSortOrder:"descend",sortDirections:["descend","ascend","descend"],sorter:function(e,n){var i=de()(e.created_at),t=de()(n.created_at);return i.diff(t)}},{title:n("modelService.DesiredSessionCount"),dataIndex:"desired_session_count",key:"desiredSessionCount",render:function(e){return e<0?"-":e}},{title:(0,b.jsxs)(a.Z,{direction:"column",align:"start",children:[n("modelService.RoutingsCount"),(0,b.jsx)("br",{}),(0,b.jsxs)(le.Z.Text,{type:"secondary",style:{fontWeight:"normal"},children:["(",n("modelService.Active/Total"),")"]})]}),key:"routingCount",render:function(e,n){var i;return T().filter(n.routings,(function(e){return"HEALTHY"===(null===e||void 0===e?void 0:e.status)})).length+" / "+(null===(i=n.routings)||void 0===i?void 0:i.length)}},{title:n("modelService.Public"),key:"public",render:function(e,n){return n.open_to_public?(0,b.jsx)(G.Z,{style:{color:d.colorSuccess}}):(0,b.jsx)(B.Z,{style:{color:d.colorTextSecondary}})}}]),ye=re("backendaiwebui.ServingListPage.displayedColumnKeys",{defaultValue:pe.map((function(e){return T().toString(e.key)}))}),he=(0,r.Z)(ye,2),Se=he[0],xe=he[1];Y((function(){(0,Z.startTransition)((function(){te()}))}),7e3);var ke=(0,ce.useLazyLoadQuery)(void 0!==ie?ie:ie=i(16142),{offset:(R.current-1)*R.pageSize,limit:R.pageSize,projectID:v.id},{fetchPolicy:"initial-fetch"===ne?"store-and-network":"network-only",fetchKey:ne}).endpoint_list,Ze=T().sortBy(null===ke||void 0===ke?void 0:ke.items,"name"),be=(0,f.Y)({mutationFn:function(){return(0,c.Lc)({method:"DELETE",url:"/services/"+(null===F||void 0===F?void 0:F.endpoint_id),client:u})}});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(a.Z,{direction:"column",align:"stretch",style:{padding:d.padding},gap:"xs",children:[(0,b.jsxs)(a.Z,{direction:"column",align:"stretch",children:[(0,b.jsx)(a.Z,{style:{flex:1},children:(0,b.jsx)(ae.Z,{activeKey:fe,onChange:function(e){return ge(e)},tabBarStyle:{marginBottom:0},style:{width:"100%",paddingLeft:d.paddingMD,paddingRight:d.paddingMD,borderTopLeftRadius:d.borderRadius,borderTopRightRadius:d.borderRadius},items:[{key:"services",label:n("modelService.Services")}],tabBarExtraContent:{right:(0,b.jsx)(oe.ZP,{type:"primary",onClick:function(){h(!0)},children:n("modelService.StartService")})}})}),(0,b.jsx)(Z.Suspense,{fallback:(0,b.jsx)("div",{children:"loading.."}),children:(0,b.jsx)(se.Z,{loading:V,scroll:{x:"max-content"},rowKey:"endpoint_id",dataSource:Ze||[],columns:pe.filter((function(e){return null===Se||void 0===Se?void 0:Se.includes(T().toString(e.key))})),pagination:!1})})]}),(0,b.jsx)(a.Z,{justify:"end",children:(0,b.jsx)(oe.ZP,{type:"text",icon:(0,b.jsx)(O.Z,{}),onClick:function(){_(!0)}})})]}),(0,b.jsx)(l.Z,{open:W,title:n("dialog.title.LetsDouble-Check"),okButtonProps:{loading:be.isLoading},onOk:function(){be.mutate(void 0,{onSuccess:function(e){$((function(){te()})),J(!1)},onError:function(e){console.log("terminateModelServiceMutation Error",e)}})},onCancel:function(){J(!1)},children:(0,b.jsxs)(a.Z,{direction:"column",align:"stretch",justify:"center",children:[(0,b.jsx)("p",{children:n("modelService.YouAreAboutToTerminate")+((null===F||void 0===F?void 0:F.name)||"")+"."}),(0,b.jsx)("p",{children:n("dialog.ask.DoYouWantToProceed")})]})}),(0,b.jsx)(s.Z,{open:D,onRequestClose:function(e){L(!1),e&&$((function(){te()}))},endpointFrgmt:F||null}),(0,b.jsx)(M,{open:y,onRequestClose:function(e){h(!y),e&&$((function(){te()}))}}),(0,b.jsx)(z,{open:k,onRequestClose:function(e){(null===e||void 0===e?void 0:e.selectedColumnKeys)&&xe(null===e||void 0===e?void 0:e.selectedColumnKeys),_(!1)},columns:pe,displayedColumnKeys:Se||[]})]})}},16142:function(e,n,i){i.r(n);var t=function(){var e={defaultValue:null,kind:"LocalArgument",name:"limit"},n={defaultValue:null,kind:"LocalArgument",name:"offset"},i={defaultValue:null,kind:"LocalArgument",name:"projectID"},t=[{kind:"Literal",name:"filter",value:"name != 'koalpaca-test'"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"project",variableName:"projectID"}],r={alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"endpoint_id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"image",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"model",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"project",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"resource_group",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"resource_slots",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"open_to_public",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"created_user",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"desired_session_count",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"routing_id",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"endpoint",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"session",storageKey:null},Z={alias:null,args:null,kind:"ScalarField",name:"traffic_ratio",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[e,n,i],kind:"Fragment",metadata:null,name:"ServingListPageQuery",selections:[{alias:null,args:t,concreteType:"EndpointList",kind:"LinkedField",name:"endpoint_list",plural:!1,selections:[r,{alias:null,args:null,concreteType:"Endpoint",kind:"LinkedField",name:"items",plural:!0,selections:[l,o,a,s,u,d,c,m,v,f,g,p,y,{kind:"RequiredField",field:h,action:"NONE",path:"endpoint_list.items.desired_session_count"},{alias:null,args:null,concreteType:"Routing",kind:"LinkedField",name:"routings",plural:!0,selections:[S,x,k,Z,d],storageKey:null},{args:null,kind:"FragmentSpread",name:"ModelServiceSettingModal_endpoint"},{args:null,kind:"FragmentSpread",name:"EndpointStatusTagFragment"}],storageKey:null}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,e,i],kind:"Operation",name:"ServingListPageQuery",selections:[{alias:null,args:t,concreteType:"EndpointList",kind:"LinkedField",name:"endpoint_list",plural:!1,selections:[r,{alias:null,args:null,concreteType:"Endpoint",kind:"LinkedField",name:"items",plural:!0,selections:[l,o,a,s,u,d,c,m,v,f,g,p,y,h,{alias:null,args:null,concreteType:"Routing",kind:"LinkedField",name:"routings",plural:!0,selections:[S,x,k,Z,d,b],storageKey:null},b],storageKey:null}],storageKey:null}]},params:{cacheID:"b3f7122c428341734000f9de6c03928c",id:null,metadata:{},name:"ServingListPageQuery",operationKind:"query",text:'query ServingListPageQuery(\n  $offset: Int!\n  $limit: Int!\n  $projectID: UUID\n) {\n  endpoint_list(offset: $offset, limit: $limit, project: $projectID, filter: "name != \'koalpaca-test\'") {\n    total_count\n    items {\n      name\n      endpoint_id\n      image\n      model\n      domain\n      status\n      project\n      resource_group\n      resource_slots\n      url\n      open_to_public\n      created_at @since(version: "23.09.0")\n      created_user\n      desired_session_count\n      routings {\n        routing_id\n        endpoint\n        session\n        traffic_ratio\n        status\n        id\n      }\n      ...ModelServiceSettingModal_endpoint\n      ...EndpointStatusTagFragment\n      id\n    }\n  }\n}\n\nfragment EndpointStatusTagFragment on Endpoint {\n  id\n  status\n}\n\nfragment ModelServiceSettingModal_endpoint on Endpoint {\n  endpoint_id\n  desired_session_count\n}\n'}}}();t.hash="4bdd65d4de1c5a874a4377337f62fe49",n.default=t},28501:function(e,n,i){i.d(n,{Z:function(){return s}});var t=i(87462),r=i(4519),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},o=i(9491),a=function(e,n){return r.createElement(o.Z,(0,t.Z)({},e,{ref:n,icon:l}))};var s=r.forwardRef(a)},43596:function(e,n,i){i.d(n,{Z:function(){return s}});var t=i(87462),r=i(4519),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"},o=i(9491),a=function(e,n){return r.createElement(o.Z,(0,t.Z)({},e,{ref:n,icon:l}))};var s=r.forwardRef(a)}}]);
//# sourceMappingURL=648.605cb364.chunk.js.map