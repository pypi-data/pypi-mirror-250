import{_ as e,D as t}from"./ConfigEditor-doWTLv5A.js";import{_ as a,C as s,u as n,D as i,i as r,q as l,E as d,o as m,a as o,b as p,n as c,d as u,e as x,w as v,x as f,t as g,f as b,F as h,v as _,r as y,h as w,m as I,c as $,l as E,G as S,g as j,H as k,I as R}from"./index-LACzRkOd.js";import"./SLLoading-fGGpWiXo.js";const L={class:"w-full h-full py-5 relative"},C={class:"px-6 border-b"},D={class:"flex items-center gap-3"},N={class:"text-2xl items-center gap-1 truncate max-w-sm sm:max-w-lg 2xl:max-w-5xl"},q={class:"font-semibold"},B={key:0,class:"experiment-description"},F={class:"experiment-navs"},G={class:"w-full overflow-y-auto pb-10"},H=a({__name:"ExperimentLayout",setup(a){const $=s(),E=n(),S=i(),j=r("isSideBarShow"),k=()=>{w.delete(`/experiment/${S.id}`).then((({data:e})=>{E.setProject(e.project),$.replace("/").then((()=>{I.success("Delete Successfully")}))})).catch((({data:e})=>{I.error(e.message)}))},R=async(e,t)=>{const a=S.id,{data:s}=await w.patch(`/experiment/${a}`,e);S.setExperiment(s.experiment),E.setExperimentInfo(a,e),t()},H=[{label:l("experiment.navs.index"),to:`/experiment/${S.id}/index`},{label:l("experiment.navs.chart"),to:`/experiment/${S.id}/chart`},{label:l("experiment.navs.log"),to:`/experiment/${S.id}/log`},{label:l("experiment.navs.env"),to:`/experiment/${S.id}/env`}];return(a,s)=>{const n=d("RouterLink");return m(),o("div",L,[p("div",C,[p("div",{class:c(["experiment-title transition-marging duration-300",{"ml-8":!u(j)}])},[p("div",D,[p("h1",N,[x(n,{class:"hover:underline underline-offset-2",to:"/"},{default:v((()=>[f(g(u(E).name),1)])),_:1}),f(" / "),p("span",q,g(u(S).name),1)]),x(e,{type:"experiment",onModify:R,disabled:u(S).isRunning},null,8,["disabled"])]),p("div",{class:c(["flex justify-end grow transition-padding duration-300 ml-1",{"pr-8":!u(j)}])},[x(t,{type:"experiment",disabled:u(S).isRunning,onConfirm:k},null,8,["disabled"])],2)],2),u(S).description?(m(),o("p",B,g(u(S).description),1)):b("",!0),p("nav",F,[(m(),o(h,null,_(H,(e=>x(n,{class:"nav-item","active-class":"nav-active","data-text":e.label,key:e.to,to:e.to},{default:v((()=>[f(g(e.label),1)])),_:2},1032,["data-text","to"]))),64))])]),p("div",G,[y(a.$slots,"default",{},void 0,!0)])])}}},[["__scopeId","data-v-89dd88d0"]]),M={__name:"ExperimentView",setup(e){const t=R(),a=i(),s=n(),r=$((()=>void 0!==a.id)),l=E(0),p=async(e=t.params.experimentId)=>{a.experiment=void 0,a.charts=void 0,w.get(`/experiment/${e}`).then((({data:e})=>{a.experiment=e,s.setExperimentStatus(e.experiment_id,e.status,e.update_time),a.isRunning&&f()})).catch((e=>{var t;l.value=(null==(t=e.data)?void 0:t.code)||3e3}))};p(),S(((e,t)=>{e.params.experimentId!==t.params.experimentId&&(p(e.params.experimentId),clearInterval(c))}));let c=null;const f=()=>{c=setInterval((()=>{w.get(`/experiment/${a.id}/status`).then((({data:e})=>{Number(a.id)===Number(t.params.experimentId)?(a.setStatus(e.status),a.setUpateTime(e.update_time),s.setExperimentStatus(a.id,e.status,e.update_time),a.charts=e.charts,a.isRunning||clearInterval(c)):clearInterval(c)}))}),1e3)};return(e,t)=>{const s=d("router-view");return m(),o(h,null,[r.value?(m(),j(H,{key:u(a).id},{default:v((()=>[x(s)])),_:1})):b("",!0),!r.value&&l.value?(m(),j(k,{key:1,code:l.value},null,8,["code"])):b("",!0)],64)}}};export{M as default};
