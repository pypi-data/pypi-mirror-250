sources:
  poll:
    type: poll
    handle: holding
    poll_interval: 0
    blocks:
      - [0, 10]
  poll_input:
    type: poll
    handle: input
    poll_interval: 0.5
    blocks:
      - [0, 10]
parameters:
  reg-0:
    source: poll
    form:
      type: ParamMask
      address: 0
      idx: reg-0
      mask: 0xff
    triggers:
      process:
        send:
          - [always]
          - [state]
      write:
        validators:
        - trig_type: range
          min: 0
          max: 255
  reg-1:
    source: poll
    form:
      type: Param
      address: 1
      idx: reg-1
    triggers:
      process:
        send:
          - [always]
      write:
        validators:
        - trig_type: writable
    sequences:
      write:
        - type: write_value
          value: 0
        - type: wait
          seconds: 1
        - type: write
  reg-2-bits:
    source: poll
    form:
      type: ParamBits
      address: 2
      bitmask:
        reg-2-bit-0: 0
        reg-2-bit-1: 1
        reg-2-bit-2: 2
        reg-2-bit-3: 3
        reg-2-bit-4: 4
        reg-2-bit-5: 5
        reg-2-bit-7: 7
        reg-2-bit-8: 8
        reg-2-bit-9: 9
        reg-2-bit-10: 10
        reg-2-bit-11: 11
        reg-2-bit-12: 12
        reg-2-bit-13: 13
        reg-2-bit-14: 14
        reg-2-bit-15: 15
    triggers:
      write:
        validators:
        - trig_type: writable
  reg-3:
    source: poll
    form:
      type: Param
      address: 3
      idx: reg-3
    children:
      reg-3-bit-0:
        form:
          type: ParamBit
          address: 3
          idx: reg-3-bit-0
          bit: 0
        triggers:
          process:
            send:
              - [always]
          write:
            validators:
              - trig_type: writable
      reg-3-bit-1:
        form:
          type: ParamBit
          address: 3
          idx: reg-3-bit-1
          bit: 1
        triggers:
          write:
            validators:
              - trig_type: writable
          process:
            send:
              - [always]
      reg-3-bit-2:
        form:
          type: ParamBit
          address: 3
          idx: reg-3-bit-2
          bit: 2
        triggers:
          write:
            validators:
              - trig_type: writable
    triggers:
      process:
        send:
          - [always]
  reg-4:
    source: poll
    form:
      type: Param
      address: 4
      idx: reg-4
    triggers:
      process:
        send:
          - trig_type: and
            triggers:
              - trig_type: comparison
                ref_name: current_state
                ref_key: reg-0
                comp_type: e
                comp_value: 5
              - [time, 5]
  reg-5:
    source: poll
    form:
      type: Param
      address: 5
      idx: reg-5
    triggers:
      process:
        send:
          - [always]
  reg-6:
    source: poll
    form:
      type: Param
      address: 6
      idx: reg-6
    triggers:
      process:
        send:
          - [always]
  reg-7:
    source: poll
    form:
      type: Param
      address: 7
      idx: reg-7
    triggers:
      process:
        send:
          - [always]
  reg-8:
    source: poll
    form:
      type: Param
      address: 8
      idx: reg-8
    triggers:
      process:
        send:
          - [always]
  reg-9:
    source: poll
    form:
      type: Param
      address: 9
      idx: reg-9
    triggers:
      process:
        send:
          - [always]
  reg-0-input:
    source: poll_input
    form:
      type: ParamMask
      address: 0
      idx: reg-0-input
      mask: 0xff
    triggers:
      process:
        send:
          - [always]
          - [state]
