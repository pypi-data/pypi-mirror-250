[tool.poetry]
name = "GenJAX"
version = "0.1.0"
description = "Probabilistic programming with Gen, built on top of JAX."
authors = [
  "McCoy R. Becker <mccoyb@mit.edu>",
  "MIT Probabilistic Computing Project <probcomp-assist@csail.mit.edu>"
]
maintainers = [
  "McCoy R. Becker <mccoyb@mit.edu>",
  "Colin Smith <colin.smith@gmail.com>",
  "Sam Ritchie <sam@mentat.org>",
]
license = "Apache 2.0"
readme = "README.md"
homepage = "https://github.com/probcomp/genjax"
repository = "https://github.com/probcomp/genjax"
documentation = "https://probcomp.github.io/genjax/"
keywords = [
  "artificial-intelligence",
  "probabilistic-programming",
  "bayesian-inference",
  "differentiable-programming"
]
classifiers = [
  "Development Status :: 4 - Beta",
  "Programming Language :: Python :: 3.9",
  "Programming Language :: Python :: 3.10",
  "Programming Language :: Python :: 3.11",
  "Programming Language :: Python :: 3.12"
]

[tool.poetry.urls]
Changelog = "https://github.com/probcomp/genjax/releases"

[tool.poetry.dependencies]
python = ">=3.9,<3.13"
jax = "^0.4.20"
numpy = "^1.26.3"
tensorflow-probability = "^0.21.0"
rich = "^13.7.0"
jaxtyping = "^0.2.24"
optax = "^0.1.7"
beartype = "^0.16.4"
dill = "^0.3.7"
pygments = "^2.17.2"
plum-dispatch = "^2.2.2"
equinox = "^0.11.2"

[tool.poetry.group.dev]
optional = true

[tool.poetry.group.dev.dependencies]
blackjax = "^0.9.6"
coverage = "^7.0.0"
darglint = "^1.8.1"
jupyterlab = "^3.5.1"
matplotlib = "^3.6.2"
mypy = "^0.991"
nbmake = "^1.4.6"
pytest = "^7.2.0"
pytest-benchmark = "^4.0.0"
pytest-xdist = {version = "^3.2.0", extras = ["psutil"] }
ruff = "^0.1.3"
safety = "^2.3.5"
seaborn = "^0.12.1"
tinygp = "^0.2.3"
xdoctest = "^1.1.0"

[tool.poetry.group.docs]
optional = true

[tool.poetry.group.docs.dependencies]
mkdocs = "^1.5.3"
mkdocs-git-authors-plugin = "^0.7.2"
mkdocs-git-revision-date-localized-plugin = "^1.1.0"
mkdocs-git-committers-plugin-2 = "^1.1.1"
markdown-exec = {version="^1.6.0", extras=["ansi"]}
mkdocs-material = { git = "git@github.com:probcomp/mkdocs-material-insiders.git" }
mkdocstrings = { extras=["python"], git = "https://github.com/mkdocstrings/mkdocstrings.git", tag="0.24.0" }

[tool.poetry.extras]
tinygp = ["tinygp"]
blackjax = ["blackjax"]
all = ["blackjax", "tinygp"]

[tool.coverage.paths]
source = ["src", "*/site-packages"]
tests = ["tests", "*/tests"]

[tool.coverage.run]
omit = [".*", "*/site-packages/*"]

[tool.coverage.report]
show_missing = true
fail_under = 45

[tool.ruff]
exclude = [
    ".bzr",
    ".direnv",
    ".eggs",
    ".git",
    ".git-rewrite",
    ".hg",
    ".mypy_cache",
    ".nox",
    ".pants.d",
    ".pytype",
    ".ruff_cache",
    ".svn",
    ".tox",
    ".venv",
    "__pypackages__",
    "_build",
    "buck-out",
    "build",
    "dist",
    "node_modules",
    "venv"
]
extend-include = ["*.ipynb"]
line-length = 88
indent-width = 4

[tool.ruff.lint]
extend-select = ["I"]
select = ["E4", "E7", "E9", "F"]
# F811 silences errors from GenJAX's type-based dispatch. Remove this if we can
# find some way to teach ruff about these overloads.
#
# F403 disables errors from `*` imports, which we currently use heavily.
ignore = ["F811", "F403"]
fixable = ["ALL"]
unfixable = []
dummy-variable-rgx = "^(_+|(_+[a-zA-Z0-9_]*[a-zA-Z0-9]+?))$"

[tool.ruff.format]
quote-style = "double"
indent-style = "space"
skip-magic-trailing-comma = false
line-ending = "auto"

[tool.mypy]
strict = true
warn_unreachable = true
pretty = true
show_column_numbers = true
show_error_codes = true
show_error_context = true

[tool.poetry-dynamic-versioning]
enable = false
vcs = "git"
style = "pep440"

[build-system]
requires = ["poetry-core>=1.0.0", "poetry-dynamic-versioning>=1.0.0,<2.0.0"]
build-backend = "poetry_dynamic_versioning.backend"
