import logging
import pandas as pd
from timewise import ParentSampleBase, WISEDataDESYCluster

from timewise_sup.config_loader import TimewiseSUPConfig
from timewise_sup.mongo import DatabaseConnector, Index


logger = logging.getLogger(__name__)

sjoerts_base_name = "sjoerts_flares"
sjoerts_database_name = sjoerts_base_name


def get_test_flares_config():
    config = TimewiseSUPConfig(
        database_name=sjoerts_database_name,
        wise_data=TestWISEData()
    )
    return config


class TestWISEData(WISEDataDESYCluster):

    def __init__(self, **kwargs):
        super(TestWISEData, self).__init__(
            base_name=TestParentSample.base_name,
            parent_sample_class=TestParentSample,
            n_chunks=2,
            min_sep_arcsec=6
        )

    def submit_to_cluster(
            self,
            node_memory,
            single_chunk=None,
            mask_by_position=False
    ):
        logger.info("emulating cluster work")

        # from timewise/wise_bigdata_desy_cluster.py
        if isinstance(single_chunk, type(None)):
            _start_id = 1
            _end_id = int(self.n_chunks*self.n_cluster_jobs_per_chunk)
        else:
            _start_id = int(single_chunk*self.n_cluster_jobs_per_chunk) + 1
            _end_id = int(_start_id + self.n_cluster_jobs_per_chunk) - 1

        logger.debug(f"Jobs from {_start_id} to {_end_id}")

        for job_id in range(_start_id, _end_id+1):
            logger.debug(f"Job {job_id}")
            chunk_number = self._get_chunk_number_for_job(job_id)
            self._subprocess_select_and_bin(service='tap', chunk_number=chunk_number, jobID=job_id)
            self.calculate_metadata(service='tap', chunk_number=chunk_number, jobID=job_id)

        return 1

    def wait_for_job(self, job_id=None):
        logger.info("called dummy wait for cluster")


class TestParentSample(ParentSampleBase):

    base_name = sjoerts_base_name

    default_keymap = {
        "ra": "ra",
        "dec": "dec",
        "id": "name"
    }

    def __init__(self):
        logger.info("initialising test ParentSample")
        super(TestParentSample, self).__init__(base_name=TestParentSample.base_name)
        self.df = self.sample()

    def get_redshifts(self, index: Index) -> pd.DataFrame:
        redshifts = self.df.loc[index, ["z"]]
        redshifts = redshifts[redshifts != 'â€“'].astype(float)
        redshifts = redshifts[~redshifts["z"].isna()]
        redshifts["z_unc"] = redshifts["z"] * 0.01
        redshifts.set_index(redshifts.index.astype(str), inplace=True)
        return redshifts

    @staticmethod
    def sample():
        _sample = {
            "0":{
                "name":"AT2019dsg",
                "tpeak":58620.2,
                "risetime":"32.1",
                "fadetime":"81.9",
                "df_over_rms":92.2,
                "df_raw":"1.58 \u00b1 0.02",
                "z":"0.0512",
                "mbh":"6.74 (C21)",
                "pagntde":0.0,
                "class":"TDE",
                "df":1.58,
                "df_e":0.02,
                "ra":314.2623926,
                "dec":14.2044063
            },
            "1":{
                "name":"AT2019fdr",
                "tpeak":58672.5,
                "risetime":"30.8",
                "fadetime":"336.6",
                "df_over_rms":39.2,
                "df_raw":"0.71 \u00b1 0.07",
                "z":"0.2666",
                "mbh":"7.10 (F20)",
                "pagntde":0.0,
                "class":"TDE?",
                "df":0.71,
                "df_e":0.07,
                "ra":257.278578935,
                "dec":26.8556946632
            },
            "2":{
                "name":"AT2019aalc",
                "tpeak":58658.2,
                "risetime":"49.0",
                "fadetime":"167.7",
                "df_over_rms":15.7,
                "df_raw":"11.13 \u00b1 0.10",
                "z":"0.0356",
                "mbh":"7.23 (L19)",
                "pagntde":0.184,
                "class":"TDE?",
                "df":11.13,
                "df_e":0.1,
                "ra":231.069435,
                "dec":4.855293
            },
            "3":{
                "name":"AT2018dyk",
                "tpeak":58261.4,
                "risetime":"60.0",
                "fadetime":"342.0",
                "df_over_rms":23.8,
                "df_raw":"1.41 \u00b1 0.03",
                "z":"0.0367",
                "mbh":"5.50 (F19)",
                "pagntde":0.005,
                "class":"TDE?",
                "df":1.41,
                "df_e":0.03,
                "ra":233.2833955,
                "dec":44.5356122
            },
            "4":{
                "name":"AT2019aame",
                "tpeak":58363.2,
                "risetime":"\u2013",
                "fadetime":"138.0",
                "df_over_rms":12.3,
                "df_raw":"0.18 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.557,
                "class":"\u2013",
                "df":0.18,
                "df_e":0.01,
                "ra":215.0518185286,
                "dec":31.89418265
            },
            "5":{
                "name":"AT2018lzs",
                "tpeak":58378.2,
                "risetime":"134.0",
                "fadetime":"15.5",
                "df_over_rms":3.3,
                "df_raw":"0.03 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":4.144,
                "class":"\u2013",
                "df":0.03,
                "df_e":0.01,
                "ra":268.2332285889,
                "dec":58.6364428511
            },
            "6":{
                "name":"AT2021aetz",
                "tpeak":58390.3,
                "risetime":"8.6",
                "fadetime":"\u2013",
                "df_over_rms":47.5,
                "df_raw":"0.81 \u00b1 0.01",
                "z":"0.0879",
                "mbh":"6.21 (T13)",
                "pagntde":0.0,
                "class":"TDE?",
                "df":0.81,
                "df_e":0.01,
                "ra":327.7322406433,
                "dec":-1.1150629733
            },
            "7":{
                "name":"AT2018ige",
                "tpeak":58432.5,
                "risetime":"\u2013",
                "fadetime":"67.9",
                "df_over_rms":65.8,
                "df_raw":"0.31 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.0,
                "class":"\u2013",
                "df":0.31,
                "df_e":0.01,
                "ra":118.6380507,
                "dec":9.4941259
            },
            "8":{
                "name":"AT2021aeud",
                "tpeak":58448.3,
                "risetime":"137.6",
                "fadetime":"282.7",
                "df_over_rms":6.2,
                "df_raw":"0.15 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":4.288,
                "class":"\u2013",
                "df":0.15,
                "df_e":0.01,
                "ra":105.2337905077,
                "dec":36.9809554742
            },
            "9":{
                "name":"AT2018iql",
                "tpeak":58449.4,
                "risetime":"17.9",
                "fadetime":"41.0",
                "df_over_rms":30.1,
                "df_raw":"0.48 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.0,
                "class":"\u2013",
                "df":0.48,
                "df_e":0.01,
                "ra":74.579667,
                "dec":-7.767961
            },
            "10":{
                "name":"AT2018jut",
                "tpeak":58449.6,
                "risetime":"\u2013",
                "fadetime":"\u2013",
                "df_over_rms":5.0,
                "df_raw":"0.12 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":5.782,
                "class":"\u2013",
                "df":0.12,
                "df_e":0.01,
                "ra":208.534625,
                "dec":13.03225
            },
            "11":{
                "name":"AT2021aeue",
                "tpeak":58475.1,
                "risetime":"48.5",
                "fadetime":"48.8",
                "df_over_rms":4.9,
                "df_raw":"0.11 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":5.881,
                "class":"\u2013",
                "df":0.11,
                "df_e":0.01,
                "ra":35.7932062129,
                "dec":-9.5400954879
            },
            "12":{
                "name":"AT2019aamf",
                "tpeak":58506.4,
                "risetime":"80.0",
                "fadetime":"141.2",
                "df_over_rms":6.6,
                "df_raw":"0.19 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":3.744,
                "class":"\u2013",
                "df":0.19,
                "df_e":0.01,
                "ra":134.2561491783,
                "dec":33.9149887048
            },
            "13":{
                "name":"AT2018kox",
                "tpeak":58510.2,
                "risetime":"26.9",
                "fadetime":"167.6",
                "df_over_rms":5.6,
                "df_raw":"0.33 \u00b1 0.01",
                "z":"0.096",
                "mbh":"\u2013",
                "pagntde":5.046,
                "class":"\u2013",
                "df":0.33,
                "df_e":0.01,
                "ra":70.793375,
                "dec":-4.303081
            },
            "14":{
                "name":"AT2018lhv",
                "tpeak":58513.5,
                "risetime":"17.5",
                "fadetime":"116.1",
                "df_over_rms":32.3,
                "df_raw":"0.35 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.0,
                "class":"\u2013",
                "df":0.35,
                "df_e":0.01,
                "ra":196.3538001,
                "dec":21.9544627
            },
            "15":{
                "name":"AT2019avd",
                "tpeak":58534.3,
                "risetime":"14.9",
                "fadetime":"52.9",
                "df_over_rms":67.5,
                "df_raw":"1.87 \u00b1 0.05",
                "z":"0.0296",
                "mbh":"6.10 (F20)",
                "pagntde":0.0,
                "class":"TDE?",
                "df":1.87,
                "df_e":0.05,
                "ra":125.9031975,
                "dec":4.3840166
            },
            "16":{
                "name":"AT2016eix",
                "tpeak":58539.4,
                "risetime":"104.2",
                "fadetime":"43.1",
                "df_over_rms":6.9,
                "df_raw":"0.16 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":3.277,
                "class":"\u2013",
                "df":0.16,
                "df_e":0.01,
                "ra":244.7164389917,
                "dec":63.173373975
            },
            "17":{
                "name":"AT2019aamg",
                "tpeak":58540.5,
                "risetime":"\u2013",
                "fadetime":"93.7",
                "df_over_rms":8.3,
                "df_raw":"0.14 \u00b1 0.00",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":1.945,
                "class":"\u2013",
                "df":0.14,
                "df_e":0.0,
                "ra":272.0540027145,
                "dec":50.7867327618
            },
            "18":{
                "name":"AT2018lcp",
                "tpeak":58547.2,
                "risetime":"95.7",
                "fadetime":"297.4",
                "df_over_rms":12.7,
                "df_raw":"0.16 \u00b1 0.01",
                "z":"0.06",
                "mbh":"\u2013",
                "pagntde":0.495,
                "class":"\u2013",
                "df":0.16,
                "df_e":0.01,
                "ra":117.7084162,
                "dec":1.3583501
            },
            "19":{
                "name":"AT2021aeuf",
                "tpeak":58556.4,
                "risetime":"17.0",
                "fadetime":"137.5",
                "df_over_rms":15.6,
                "df_raw":"0.18 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.192,
                "class":"\u2013",
                "df":0.18,
                "df_e":0.01,
                "ra":191.0284513551,
                "dec":47.4451350536
            },
            "20":{
                "name":"AT2020aezy",
                "tpeak":58558.4,
                "risetime":"82.5",
                "fadetime":"359.8",
                "df_over_rms":4.8,
                "df_raw":"0.06 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":5.929,
                "class":"\u2013",
                "df":0.06,
                "df_e":0.01,
                "ra":213.3346372536,
                "dec":44.316804259
            },
            "21":{
                "name":"AT2019cle",
                "tpeak":58568.4,
                "risetime":"9.2",
                "fadetime":"54.8",
                "df_over_rms":19.4,
                "df_raw":"0.25 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.041,
                "class":"\u2013",
                "df":0.25,
                "df_e":0.01,
                "ra":267.7546372,
                "dec":14.9183971
            },
            "22":{
                "name":"AT2019aamh",
                "tpeak":58582.5,
                "risetime":"\u2013",
                "fadetime":"154.5",
                "df_over_rms":7.7,
                "df_raw":"0.40 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":2.459,
                "class":"\u2013",
                "df":0.4,
                "df_e":0.01,
                "ra":333.2692337174,
                "dec":23.562021663
            },
            "23":{
                "name":"AT2019dll",
                "tpeak":58605.2,
                "risetime":"29.6",
                "fadetime":"\u2013",
                "df_over_rms":6.8,
                "df_raw":"0.26 \u00b1 0.01",
                "z":"0.101",
                "mbh":"7.48 (T13)",
                "pagntde":3.461,
                "class":"TDE?",
                "df":0.26,
                "df_e":0.01,
                "ra":175.347926,
                "dec":21.9368582
            },
            "24":{
                "name":"AT2019gur",
                "tpeak":58607.5,
                "risetime":"\u2013",
                "fadetime":"234.5",
                "df_over_rms":38.6,
                "df_raw":"0.34 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.0,
                "class":"\u2013",
                "df":0.34,
                "df_e":0.01,
                "ra":343.7032652,
                "dec":77.3529674
            },
            "25":{
                "name":"AT2018lof",
                "tpeak":58608.2,
                "risetime":"70.9",
                "fadetime":"370.4",
                "df_over_rms":4.1,
                "df_raw":"0.15 \u00b1 0.01",
                "z":"0.302",
                "mbh":"8.98 (L19)",
                "pagntde":5.974,
                "class":"AGN",
                "df":0.15,
                "df_e":0.01,
                "ra":135.2537131,
                "dec":35.6355391
            },
            "26":{
                "name":"AT2019dqv",
                "tpeak":58628.2,
                "risetime":"67.0",
                "fadetime":"475.0",
                "df_over_rms":40.4,
                "df_raw":"1.77 \u00b1 0.02",
                "z":"0.0816",
                "mbh":"6.67 (L19)",
                "pagntde":0.0,
                "class":"TDE?",
                "df":1.77,
                "df_e":0.02,
                "ra":160.87525,
                "dec":51.35805
            },
            "27":{
                "name":"AT2019cyq",
                "tpeak":58637.2,
                "risetime":"49.5",
                "fadetime":"95.0",
                "df_over_rms":31.8,
                "df_raw":"0.54 \u00b1 0.01",
                "z":"0.262",
                "mbh":"7.56 (L19)",
                "pagntde":0.0,
                "class":"TDE?",
                "df":0.54,
                "df_e":0.01,
                "ra":149.02525,
                "dec":19.549039
            },
            "28":{
                "name":"AT2021aeug",
                "tpeak":58641.2,
                "risetime":"48.6",
                "fadetime":"68.8",
                "df_over_rms":4.6,
                "df_raw":"0.11 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":6.07,
                "class":"\u2013",
                "df":0.11,
                "df_e":0.01,
                "ra":237.5669924449,
                "dec":39.2364149934
            },
            "29":{
                "name":"AT2019ihv",
                "tpeak":58646.5,
                "risetime":"\u2013",
                "fadetime":"19.3",
                "df_over_rms":8.7,
                "df_raw":"0.29 \u00b1 0.01",
                "z":"0.1602",
                "mbh":"\u2013",
                "pagntde":1.687,
                "class":"\u2013",
                "df":0.29,
                "df_e":0.01,
                "ra":16.9496725,
                "dec":24.480088
            },
            "30":{
                "name":"AT2019dzh",
                "tpeak":58651.2,
                "risetime":"51.4",
                "fadetime":"348.9",
                "df_over_rms":6.4,
                "df_raw":"0.15 \u00b1 0.01",
                "z":"0.314",
                "mbh":"\u2013",
                "pagntde":4.007,
                "class":"\u2013",
                "df":0.15,
                "df_e":0.01,
                "ra":187.82527,
                "dec":23.7071466667
            },
            "31":{
                "name":"AT2019kqu",
                "tpeak":58652.2,
                "risetime":"95.6",
                "fadetime":"315.6",
                "df_over_rms":6.1,
                "df_raw":"0.27 \u00b1 0.01",
                "z":"0.174",
                "mbh":"7.53 (L19)",
                "pagntde":4.348,
                "class":"TDE?",
                "df":0.27,
                "df_e":0.01,
                "ra":248.061875,
                "dec":33.570211
            },
            "32":{
                "name":"AT2019hbh",
                "tpeak":58652.3,
                "risetime":"19.8",
                "fadetime":"106.7",
                "df_over_rms":8.4,
                "df_raw":"0.75 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":1.88,
                "class":"\u2013",
                "df":0.75,
                "df_e":0.01,
                "ra":278.3309038,
                "dec":34.6842225
            },
            "33":{
                "name":"AT2020aezz",
                "tpeak":58677.3,
                "risetime":"99.8",
                "fadetime":"280.6",
                "df_over_rms":5.8,
                "df_raw":"0.18 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":4.771,
                "class":"\u2013",
                "df":0.18,
                "df_e":0.01,
                "ra":267.0651933479,
                "dec":55.2369750691
            },
            "34":{
                "name":"AT2020afaa",
                "tpeak":58678.2,
                "risetime":"83.8",
                "fadetime":"330.3",
                "df_over_rms":7.0,
                "df_raw":"0.13 \u00b1 0.02",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":3.187,
                "class":"\u2013",
                "df":0.13,
                "df_e":0.02,
                "ra":209.6703992291,
                "dec":24.71194886
            },
            "35":{
                "name":"AT2019idm",
                "tpeak":58682.2,
                "risetime":"51.7",
                "fadetime":"\u2013",
                "df_over_rms":25.2,
                "df_raw":"0.41 \u00b1 0.02",
                "z":"0.0544",
                "mbh":"6.64 (T13)",
                "pagntde":0.002,
                "class":"TDE?",
                "df":0.41,
                "df_e":0.02,
                "ra":208.19525,
                "dec":20.412181
            },
            "36":{
                "name":"AT2019ihu",
                "tpeak":58709.5,
                "risetime":"79.7",
                "fadetime":"110.9",
                "df_over_rms":6.2,
                "df_raw":"0.25 \u00b1 0.02",
                "z":"0.27",
                "mbh":"8.90 (L19)",
                "pagntde":4.192,
                "class":"AGN",
                "df":0.25,
                "df_e":0.02,
                "ra":358.7379227,
                "dec":0.7055425
            },
            "37":{
                "name":"AT2019meh",
                "tpeak":58713.1,
                "risetime":"23.2",
                "fadetime":"127.9",
                "df_over_rms":29.7,
                "df_raw":"1.99 \u00b1 0.04",
                "z":"0.0935",
                "mbh":"7.06 (V21)",
                "pagntde":0.0,
                "class":"TDE?",
                "df":1.99,
                "df_e":0.04,
                "ra":321.822708,
                "dec":64.416439
            },
            "38":{
                "name":"AT2020afab",
                "tpeak":58717.2,
                "risetime":"47.5",
                "fadetime":"127.2",
                "df_over_rms":5.0,
                "df_raw":"0.22 \u00b1 0.01",
                "z":"0.2875",
                "mbh":"6.49 (V21)",
                "pagntde":5.789,
                "class":"TDE?",
                "df":0.22,
                "df_e":0.01,
                "ra":43.3340782807,
                "dec":44.3015161422
            },
            "39":{
                "name":"AT2019aami",
                "tpeak":58717.4,
                "risetime":"\u2013",
                "fadetime":"152.0",
                "df_over_rms":31.8,
                "df_raw":"0.41 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.0,
                "class":"\u2013",
                "df":0.41,
                "df_e":0.01,
                "ra":8.9311081788,
                "dec":47.2592546848
            },
            "40":{
                "name":"AT2019nna",
                "tpeak":58717.4,
                "risetime":"34.4",
                "fadetime":"87.1",
                "df_over_rms":27.0,
                "df_raw":"0.36 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.001,
                "class":"\u2013",
                "df":0.36,
                "df_e":0.01,
                "ra":357.1602868667,
                "dec":19.2628018833
            },
            "41":{
                "name":"AT2019nni",
                "tpeak":58732.2,
                "risetime":"29.1",
                "fadetime":"109.5",
                "df_over_rms":4.9,
                "df_raw":"0.36 \u00b1 0.01",
                "z":"0.137",
                "mbh":"\u2013",
                "pagntde":5.834,
                "class":"\u2013",
                "df":0.36,
                "df_e":0.01,
                "ra":328.3271920875,
                "dec":-19.22732225
            },
            "42":{
                "name":"AT2021aeuk",
                "tpeak":58733.1,
                "risetime":"43.4",
                "fadetime":"238.1",
                "df_over_rms":7.3,
                "df_raw":"0.33 \u00b1 0.01",
                "z":"0.235",
                "mbh":"\u2013",
                "pagntde":2.827,
                "class":"\u2013",
                "df":0.33,
                "df_e":0.01,
                "ra":243.2493432567,
                "dec":42.3278466066
            },
            "43":{
                "name":"AT2019hdy",
                "tpeak":58749.5,
                "risetime":"\u2013",
                "fadetime":"87.9",
                "df_over_rms":4.0,
                "df_raw":"0.20 \u00b1 0.01",
                "z":"0.442",
                "mbh":"\u2013",
                "pagntde":5.863,
                "class":"\u2013",
                "df":0.2,
                "df_e":0.01,
                "ra":142.46175,
                "dec":19.493011
            },
            "44":{
                "name":"AT2019pev",
                "tpeak":58750.1,
                "risetime":"13.1",
                "fadetime":"54.7",
                "df_over_rms":7.4,
                "df_raw":"0.19 \u00b1 0.01",
                "z":"0.097",
                "mbh":"6.40 (F20)",
                "pagntde":2.729,
                "class":"TDE?",
                "df":0.19,
                "df_e":0.01,
                "ra":67.344667,
                "dec":0.61875
            },
            "45":{
                "name":"AT2013kp",
                "tpeak":58753.1,
                "risetime":"11.9",
                "fadetime":"34.7",
                "df_over_rms":44.4,
                "df_raw":"2.14 \u00b1 0.04",
                "z":"0.01499",
                "mbh":"6.19 (N20)",
                "pagntde":0.0,
                "class":"TDE",
                "df":2.14,
                "df_e":0.04,
                "ra":71.657816604,
                "dec":-10.2263196282
            },
            "46":{
                "name":"AT2019brs",
                "tpeak":58758.1,
                "risetime":"110.9",
                "fadetime":"483.2",
                "df_over_rms":9.6,
                "df_raw":"0.78 \u00b1 0.01",
                "z":"0.3736",
                "mbh":"7.20 (F20)",
                "pagntde":1.227,
                "class":"TDE?",
                "df":0.78,
                "df_e":0.01,
                "ra":216.943333,
                "dec":29.510631
            },
            "47":{
                "name":"AT2020afac",
                "tpeak":58758.3,
                "risetime":"68.0",
                "fadetime":"95.0",
                "df_over_rms":10.8,
                "df_raw":"0.16 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.865,
                "class":"\u2013",
                "df":0.16,
                "df_e":0.01,
                "ra":268.4173941411,
                "dec":55.8575355089
            },
            "48":{
                "name":"AT2019wrd",
                "tpeak":58764.3,
                "risetime":"82.6",
                "fadetime":"\u2013",
                "df_over_rms":7.6,
                "df_raw":"0.15 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":2.562,
                "class":"\u2013",
                "df":0.15,
                "df_e":0.01,
                "ra":355.981458,
                "dec":31.37715
            },
            "49":{
                "name":"AT2021aeuh",
                "tpeak":58789.5,
                "risetime":"\u2013",
                "fadetime":"\u2013",
                "df_over_rms":3.9,
                "df_raw":"0.28 \u00b1 0.01",
                "z":"0.0834",
                "mbh":"7.39 (L19)",
                "pagntde":5.726,
                "class":"TDE?",
                "df":0.28,
                "df_e":0.01,
                "ra":181.0922350364,
                "dec":-1.3675808818
            },
            "50":{
                "name":"AT2019msq",
                "tpeak":58791.2,
                "risetime":"137.9",
                "fadetime":"\u2013",
                "df_over_rms":6.4,
                "df_raw":"0.16 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":3.933,
                "class":"\u2013",
                "df":0.16,
                "df_e":0.01,
                "ra":4.184,
                "dec":6.380089
            },
            "51":{
                "name":"AT2019qpt",
                "tpeak":58798.3,
                "risetime":"44.5",
                "fadetime":"135.1",
                "df_over_rms":13.8,
                "df_raw":"0.24 \u00b1 0.01",
                "z":"0.242",
                "mbh":"6.97 (L19)",
                "pagntde":0.355,
                "class":"TDE?",
                "df":0.24,
                "df_e":0.01,
                "ra":120.357375,
                "dec":24.929439
            },
            "52":{
                "name":"AT2020afad",
                "tpeak":58802.2,
                "risetime":"77.1",
                "fadetime":"125.5",
                "df_over_rms":3.7,
                "df_raw":"0.08 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":5.217,
                "class":"\u2013",
                "df":0.08,
                "df_e":0.01,
                "ra":103.8253070817,
                "dec":58.9846934817
            },
            "53":{
                "name":"AT2019mss",
                "tpeak":58811.6,
                "risetime":"35.2",
                "fadetime":"209.7",
                "df_over_rms":20.8,
                "df_raw":"0.38 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.021,
                "class":"\u2013",
                "df":0.38,
                "df_e":0.01,
                "ra":207.102417,
                "dec":8.5287
            },
            "54":{
                "name":"AT2019thh",
                "tpeak":58851.1,
                "risetime":"104.7",
                "fadetime":"433.8",
                "df_over_rms":72.2,
                "df_raw":"1.75 \u00b1 0.02",
                "z":"0.0506",
                "mbh":"\u2013",
                "pagntde":0.0,
                "class":"\u2013",
                "df":1.75,
                "df_e":0.02,
                "ra":336.993542,
                "dec":18.322069
            },
            "55":{
                "name":"AT2021aeui",
                "tpeak":58860.3,
                "risetime":"\u2013",
                "fadetime":"60.0",
                "df_over_rms":6.2,
                "df_raw":"0.49 \u00b1 0.02",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":4.25,
                "class":"\u2013",
                "df":0.49,
                "df_e":0.02,
                "ra":120.0832105765,
                "dec":75.8230814353
            },
            "56":{
                "name":"AT2020afae",
                "tpeak":58867.2,
                "risetime":"30.2",
                "fadetime":"42.0",
                "df_over_rms":5.2,
                "df_raw":"0.35 \u00b1 0.02",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":5.585,
                "class":"\u2013",
                "df":0.35,
                "df_e":0.02,
                "ra":76.2330876897,
                "dec":9.154180031
            },
            "57":{
                "name":"AT2020mw",
                "tpeak":58867.3,
                "risetime":"12.6",
                "fadetime":"32.1",
                "df_over_rms":6.8,
                "df_raw":"0.12 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":3.414,
                "class":"\u2013",
                "df":0.12,
                "df_e":0.01,
                "ra":122.696982646,
                "dec":11.5211300373
            },
            "58":{
                "name":"AT2020iq",
                "tpeak":58878.1,
                "risetime":"22.7",
                "fadetime":"71.5",
                "df_over_rms":24.5,
                "df_raw":"0.45 \u00b1 0.01",
                "z":"0.096",
                "mbh":"6.37 (V21)",
                "pagntde":0.003,
                "class":"TDE?",
                "df":0.45,
                "df_e":0.01,
                "ra":43.832167,
                "dec":-11.413511
            },
            "59":{
                "name":"AT2019xgg",
                "tpeak":58891.2,
                "risetime":"81.6",
                "fadetime":"446.2",
                "df_over_rms":4.4,
                "df_raw":"0.13 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":6.091,
                "class":"\u2013",
                "df":0.13,
                "df_e":0.01,
                "ra":162.2842408,
                "dec":37.2211007
            },
            "60":{
                "name":"AT2020atq",
                "tpeak":58903.2,
                "risetime":"39.3",
                "fadetime":"205.5",
                "df_over_rms":20.8,
                "df_raw":"0.66 \u00b1 0.01",
                "z":"\u2013",
                "mbh":"\u2013",
                "pagntde":0.02,
                "class":"\u2013",
                "df":0.66,
                "df_e":0.01,
                "ra":102.3235381,
                "dec":62.5134005
            },
            "61":{
                "name":"AT2021aeuj",
                "tpeak":58974.2,
                "risetime":"79.0",
                "fadetime":"233.5",
                "df_over_rms":18.1,
                "df_raw":"0.20 \u00b1 0.01",
                "z":"0.695",
                "mbh":"\u2013",
                "pagntde":0.071,
                "class":"\u2013",
                "df":0.2,
                "df_e":0.01,
                "ra":137.1072043531,
                "dec":42.8948019066
            },
            "62":{
                "name":"AT2020hle",
                "tpeak":58978.3,
                "risetime":"32.7",
                "fadetime":"62.9",
                "df_over_rms":21.0,
                "df_raw":"0.33 \u00b1 0.01",
                "z":"0.103",
                "mbh":"6.40 (F20)",
                "pagntde":0.018,
                "class":"TDE?",
                "df":0.33,
                "df_e":0.01,
                "ra":166.9286271,
                "dec":74.63393225
            }
        }
        _df = pd.DataFrame.from_dict(_sample, orient="index")
        _df.index = _df.index.astype(int)
        return _df
